{"version":3,"file":"lib_index_js.5eedad9bb48a322ac20b.js","mappings":"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","sources":["webpack://jupyter-fs/./src/auth.tsx","webpack://jupyter-fs/./src/clipboard.ts","webpack://jupyter-fs/./src/commands.ts","webpack://jupyter-fs/./src/contents_proxy.ts","webpack://jupyter-fs/./src/contents_utils.ts","webpack://jupyter-fs/./src/drag.ts","webpack://jupyter-fs/./src/filesystem.ts","webpack://jupyter-fs/./src/icons.ts","webpack://jupyter-fs/./src/index.tsx","webpack://jupyter-fs/./src/progress.tsx","webpack://jupyter-fs/./src/resources.tsx","webpack://jupyter-fs/./src/settings.ts","webpack://jupyter-fs/./src/snippets.tsx","webpack://jupyter-fs/./src/tokens.ts","webpack://jupyter-fs/./src/treefinder.ts","webpack://jupyter-fs/./src/upload.ts","webpack://jupyter-fs/./src/utils.ts"],"sourcesContent":["/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport {\n  Button,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  ExpansionPanel,\n  ExpansionPanelSummary,\n  Typography,\n  ExpansionPanelDetails,\n  TextField,\n  InputAdornment,\n  IconButton,\n  Tooltip,\n} from \"@material-ui/core\";\nimport * as React from \"react\";\n\nimport { IFSOptions, IFSResource } from \"./filesystem\";\nimport { visibilityIcon, visibilityOffIcon } from \"./icons\";\n\nclass Template {\n  pattern = /(?:)/;\n\n  constructor(public template: string) {}\n\n  substitute(dict: { [key: string]: string }) {\n    return this.template.replace(this.pattern, (_, p1) => dict[p1]);\n  }\n\n  tokens() {\n    const toks = [];\n    let match;\n    // eslint-disable-next-line no-cond-assign\n    while ((match = this.pattern.exec(this.template))) {\n      toks.push(match[1]);\n    }\n    return toks;\n  }\n}\n\nexport class DoubleBraceTemplate extends Template {\n  pattern = /{{(\\S+?)}}/g;\n}\n\nfunction tokensFromUrl(url: string): string[] {\n  return new DoubleBraceTemplate(url).tokens();\n}\n\nfunction _askRequired(spec: IFSResource): boolean {\n  return spec.auth === \"ask\" && !spec.init && !!(spec.missingTokens?.length);\n}\n\nexport function askRequired(specs: IFSResource[]) {\n  for (const spec of specs) {\n    if (_askRequired(spec)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport class AskDialog<\n  P extends AskDialog.IProps = AskDialog.IProps,\n  S extends AskDialog.IState = AskDialog.IState\n> extends React.Component<P, S> {\n  static displayName = \"AskDialog\";\n\n  constructor(props: P, options: IFSOptions) {\n    super(props);\n\n    this.state = AskDialog.initialState({ open: true, options }) as Readonly<S>;\n  }\n\n  render() {\n    return (\n      <div>\n        <Dialog\n          className=\"jfs-ask-dialog\"\n          open={this.state.open}\n          onClose={this._onClose.bind(this)}\n        >\n          <DialogTitle className=\"jfs-ask jfs-ask-dialog-title\">\n            Please enter token values for filesystem resources\n          </DialogTitle>\n          <DialogContent className=\"jfs-ask jfs-ask-dialog-content\">\n            {this._form()}\n          </DialogContent>\n          <DialogActions className=\"jfs-ask jfs-ask-dialog-actions\">\n            <Button\n              className=\"jfs-ask jfs-ask-dialog-actions-button-cancel\"\n              onClick={this._onClose.bind(this)}\n              color=\"primary\"\n            >\n              Cancel\n            </Button>\n            <Button\n              className=\"jfs-ask jfs-ask-dialog-actions-button-submit\"\n              onClick={this._onSubmit.bind(this)}\n              color=\"primary\"\n            >\n              Submit\n            </Button>\n          </DialogActions>\n        </Dialog>\n      </div>\n    );\n  }\n\n  protected _form() {\n    return (\n      <form\n        className=\"jfs-ask jfs-ask-form\"\n        onSubmit={this._onSubmit.bind(this)}\n        noValidate\n        autoComplete=\"off\"\n      >\n        {this._formInner()}\n      </form>\n    );\n  }\n\n  protected _formInner() {\n    return this.props.resources.map(resource => {\n      // ask for credentials if needed, or state why not\n      const decodedUrl = decodeURIComponent(resource.url);\n      const askReq = _askRequired(resource);\n      const inputs = askReq ? this._inputs(resource.url) : [];\n      const tokens = tokensFromUrl(resource.url);\n\n      let reason = \"\";\n      if (resource.init && this.props.options.cache) {\n        reason = \"already initialized\";\n      } else if (!tokens.length) {\n        reason = \"no template parameters\";\n      }\n\n      const summary = `${resource.name}:${reason && ` ${reason}`}`;\n\n      return [\n        <ExpansionPanel\n          className=\"jfs-ask jfs-ask-panel\"\n          disabled={!!reason}\n          expanded={!reason}\n          key={`${resource.name}_panel`}\n        >\n          <ExpansionPanelSummary className=\"jfs-ask jfs-ask-panel-summary\">\n            <Typography>{summary}</Typography>\n            {!reason &&\n              <Tooltip title={decodedUrl}>\n                <Typography noWrap={true}>{decodedUrl}</Typography>\n              </Tooltip>\n            }\n          </ExpansionPanelSummary>\n          <ExpansionPanelDetails className=\"jfs-ask jfs-ask-panel-details\">\n            {inputs}\n          </ExpansionPanelDetails>\n        </ExpansionPanel>,\n      ];\n    });\n  }\n\n  protected _inputs(url: string): React.ReactNodeArray {\n    return tokensFromUrl(url).map(token => (\n      <TextField\n        className=\"jfs-ask jfs-ask-input\"\n        autoFocus\n        fullWidth\n        key={`${url}_${token}`}\n        label={token}\n        margin=\"dense\"\n        name={token}\n        onChange={this._onChange(url).bind(this)}\n        type={this.state.visibility[url]?.[token] ? \"text\" : \"password\"}\n        value={this.state.values[url]?.[token] || \"\"}\n        InputProps={{\n          endAdornment: (\n            <InputAdornment position=\"end\">\n              <IconButton\n                onClick={this._onClickVisiblity(url, token).bind(this)}\n                onMouseDown={this._onMouseDownVisibility.bind(this)}\n                edge=\"end\"\n              >\n                {this.state.visibility[url]?.[token] ? (\n                  <visibilityIcon.react />\n                ) : (\n                  <visibilityOffIcon.react />\n                )}\n              </IconButton>\n            </InputAdornment>\n          ),\n        }}\n      />\n    ));\n  }\n\n  protected _onChange(url: string) {\n    return function(event: React.ChangeEvent<HTMLInputElement>) {\n      const target = event.target;\n      this._setValue(url, target.name, target.value);\n    };\n  }\n\n  protected _onClickVisiblity(url: string, key: string) {\n    return function() {\n      this._toggleVisibility(url, key);\n    };\n  }\n\n  protected _onMouseDownVisibility(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n  }\n\n  protected _onOpen() {\n    this.setState({ open: true });\n  }\n\n  protected _onClose() {\n    // close the dialog and blank the form\n    this.setState(AskDialog.initialState({ options: this.state.options }));\n    this.props.handleClose();\n  }\n\n  protected async _onSubmit(\n    event: React.FormEvent<HTMLFormElement>\n  ): Promise<void> {\n    event.preventDefault();\n\n    this.props.handleSubmit(this.state.values);\n    this._onClose();\n  }\n\n  protected _setValue(url: string, key: string, value: string) {\n    const urlValues = { ...this.state.values[url], [key]: value };\n    this.setState({\n      values: { ...this.state.values, [url]: urlValues },\n    });\n  }\n\n  protected _toggleVisibility(url: string, key: string) {\n    const urlVis = {\n      ...this.state.visibility[url],\n      [key]: !this.state.visibility[url]?.[key],\n    };\n    this.setState({\n      visibility: { ...this.state.visibility, [url]: urlVis },\n    });\n  }\n}\n\n/**\n * A namespace for AskDialog statics.\n */\nexport namespace AskDialog {\n  /**\n   * The input props for an AskDialog component\n   */\n  export interface IProps {\n    handleClose: () => void;\n    handleSubmit: (values: {\n      [url: string]: { [key: string]: string };\n    }) => void;\n    options: IFSOptions;\n    resources: IFSResource[];\n  }\n\n  /**\n   * The initial state for a new AskDialog\n   */\n  export const initialState = ({\n    open = false,\n    options,\n  }: {\n    open?: boolean;\n    options: IFSOptions;\n  }) => ({\n    open,\n    options: { ...options },\n    values: {} as { [url: string]: { [key: string]: string } },\n    visibility: {} as { [url: string]: { [key: string]: string } },\n  });\n\n  /**\n   * The state for an AskDialog component\n   */\n  export type IState = ReturnType<typeof initialState>;\n}\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { WidgetTracker, showErrorMessage } from \"@jupyterlab/apputils\";\nimport { Drive } from \"@jupyterlab/services\";\nimport { ClipboardModel, ContentsModel, IContentRow, Path } from \"@tree-finder/base\";\n\nimport type { ContentsProxy } from \"./contents_proxy\";\nimport type { TreeFinderSidebar } from \"./treefinder\";\nimport { getRefreshTargets } from \"./contents_utils\";\n\nexport class JupyterClipboard {\n  constructor(tracker: WidgetTracker<TreeFinderSidebar>) {\n    this._tracker = tracker;\n\n    // eslint-disable-next-line @typescript-eslint/no-misused-promises\n    this._model.deleteSub.subscribe(async (memo: IContentRow[]) => {\n      await Promise.all(memo.map(s => this._onDelete(s)));\n      const contentsModel = this._tracker.currentWidget!.treefinder.model!;\n      const toRefresh = getRefreshTargets<ContentsProxy.IJupyterContentRow>(\n        memo as ContentsProxy.IJupyterContentRow[],\n        contentsModel.root,\n        true\n      );\n      this.model.refresh(contentsModel, toRefresh!);\n    });\n\n    // eslint-disable-next-line @typescript-eslint/no-misused-promises\n    this._model.pasteSub.subscribe(async ({ destination, doCut, memo }: { destination: IContentRow; doCut: boolean; memo: IContentRow[] }) => {\n      const destPath = destination.kind === \"dir\" ? destination.path : destination.path.slice(0, -1);\n      const destPathstr = Path.fromarray(destPath);\n      await Promise.all(memo.map(s => this._onPaste(s, destPathstr, doCut)));\n      const contentsModel = this._tracker.currentWidget!.treefinder.model!;\n      let toRefresh = getRefreshTargets<ContentsProxy.IJupyterContentRow>(\n        [destination] as ContentsProxy.IJupyterContentRow[],\n        contentsModel.root,\n        false\n      );\n      // Only refresh sources if cutting:\n      if (doCut && toRefresh !== undefined) {\n        const extra = getRefreshTargets<ContentsProxy.IJupyterContentRow>(\n          memo as ContentsProxy.IJupyterContentRow[],\n          contentsModel.root,\n          false\n        );\n        if (extra === undefined) {\n          toRefresh = undefined;\n        } else {\n          toRefresh.push(...extra);\n        }\n      }\n      this.model.refresh(contentsModel, toRefresh!);\n    });\n  }\n\n  refresh<T extends IContentRow>(tm?: ContentsModel<T>, memo?: T[]) {\n    tm ??= this._tracker.currentWidget!.treefinder.model as any as ContentsModel<T>;\n    this.model.refresh(tm, memo!);\n  }\n\n  // TODO: remove in favor of this.model.refreshSelection once tree-finder v0.0.14 is out\n  refreshSelection<T extends IContentRow>(tm: ContentsModel<T>) {\n    this.refresh(tm, tm.selection.map(x => x.row));\n  }\n\n  get model() {\n    return this._model;\n  }\n\n  protected async _onDelete<T extends IContentRow>(src: T) {\n    const srcPathstr = Path.fromarray(src.path);\n    try {\n      await this._drive.delete(srcPathstr);\n    } catch (err) {\n      await showErrorMessage(\"Delete Failed\", err as string);\n    }\n  }\n\n  protected async _onPaste<T extends IContentRow>(src: T, destPathstr: string, doCut: boolean) {\n    const srcPathstr = Path.fromarray(src.path);\n    try {\n      await this._drive.copy(srcPathstr, destPathstr);\n      if (doCut) {\n        await this._drive.delete(srcPathstr);\n      }\n    } catch (err) {\n      await showErrorMessage(\"Paste Error\", err as string);\n    }\n  }\n\n  protected _model = new ClipboardModel();\n  protected _tracker: WidgetTracker<TreeFinderSidebar>;\n\n  private _drive = new Drive();\n}\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\n\nimport { JupyterFrontEnd } from \"@jupyterlab/application\";\nimport { Dialog, showDialog } from \"@jupyterlab/apputils\";\nimport { DocumentRegistry } from \"@jupyterlab/docregistry\";\nimport {\n  closeIcon,\n  copyIcon,\n  cutIcon,\n  downloadIcon,\n  editIcon,\n  filterListIcon,\n  pasteIcon,\n  refreshIcon,\n  fileIcon,\n  newFolderIcon,\n  RankedMenu,\n  IDisposableMenuItem,\n} from \"@jupyterlab/ui-components\";\nimport { map } from \"@lumino/algorithm\";\nimport { DisposableSet, IDisposable } from \"@lumino/disposable\";\nimport { ContextMenu, Menu } from \"@lumino/widgets\";\nimport { Content, Path } from \"@tree-finder/base\";\n\n\nimport { JupyterClipboard } from \"./clipboard\";\nimport { TreeFinderSidebar } from \"./treefinder\";\nimport type { IFSResource } from \"./filesystem\";\nimport type { ContentsProxy } from \"./contents_proxy\";\nimport type { TreeFinderTracker } from \"./treefinder\";\nimport { getContentParent, getRefreshTargets, openDirRecursive, revealAndSelectPath, splitPathstrDrive } from \"./contents_utils\";\nimport { ISettingRegistry } from \"@jupyterlab/settingregistry\";\nimport { showErrorMessage } from \"@jupyterlab/apputils\";\nimport { getAllSnippets, instantiateSnippet, Snippet } from \"./snippets\";\n\n// define the command ids as a constant tuple\nexport const commandNames = [\n  \"copy\",\n  \"cut\",\n  \"delete\",\n  \"open\",\n  \"openWith\",\n  \"paste\",\n  \"refresh\",\n  \"rename\",\n  \"download\",\n  \"createFolder\",\n  \"createFile\",\n  // \"navigate\",\n  \"copyFullPath\",\n  \"copyRelativePath\",\n  \"restore\",\n  \"toggleColumnPath\",\n  \"toggleColumn\",\n  \"newLauncher\",\n] as const;\n\n\nexport const commandIDs = Object.fromEntries(commandNames.map(\n  name => [name, `treefinder:${name}`]\n)) as CommandIDs;\nexport type CommandIDs = {[k in typeof commandNames[number]]: string};\n\n\nconst COLUMN_NAMES = [\n  \"size\",\n  \"last_modified\",\n  \"writable\",\n  \"mimetype\",\n];\n\n\nexport function idFromResource(resource: IFSResource): string {\n  return [resource.name.split(\" \").join(\"\"), resource.drive].join(\"_\");\n}\n\n\nconst currentWidgetSelectionIsWritable = (tracker: TreeFinderTracker): boolean => {\n  if (!tracker.currentWidget) {\n    return false;\n  }\n  const selection = tracker.currentWidget.treefinder.model?.selection;\n  if (selection) {\n    return selection.every((x: Content<ContentsProxy.IJupyterContentRow>) => x.row.writable);\n  }\n  return false;\n};\n\nfunction toggleColumnCommandId(column: string): string {\n  return `${commandIDs.toggleColumn}-${column}`;\n}\n\n\nfunction _getRelativePaths(selectedFiles: Array<Content<ContentsProxy.IJupyterContentRow>>): string[] {\n  const allPaths: string[] = [];\n  for (const file of selectedFiles) {\n    const relativePath = file.getPathAtDepth(1).join(\"/\");\n    allPaths.push(relativePath);\n  }\n  return allPaths;\n}\n\n\nfunction _digestString(value: string): string {\n  return value.split(\"\").reduce((a: number, b: string) => (((a << 5) - a) + b.charCodeAt(0)) | 0, 0).toString(16);\n}\n\n\nasync function _commandKeyForSnippet(snippet: Snippet): Promise<string>  {\n  return `jupyterfs:snippet-${snippet.label}-${_digestString(snippet.label + snippet.caption + snippet.pattern.source + snippet.template)}`;\n}\n\nfunction _openWithKeyForFactory(factory: string): string  {\n  return `jupyterfs:openwith-${factory}`;\n}\n\nfunction _normalizedUrlForSnippet(content: Content<ContentsProxy.IJupyterContentRow>, baseUrl: string): string {\n  const path = splitPathstrDrive(content.pathstr)[1];\n  return `${baseUrl}/${path}${content.hasChildren ? \"/\" : \"\"}`;\n}\n\n/**\n * Create commands that will have the same IDs indepent of settings/resources\n *\n * These commands do not need to be recreated on settings/resource updates\n */\nexport function createStaticCommands(\n  app: JupyterFrontEnd,\n  tracker: TreeFinderTracker,\n  clipboard: JupyterClipboard,\n): IDisposable {\n  return [\n    app.commands.addCommand(commandIDs.copy, {\n      execute: args => clipboard.model.copySelection(tracker.currentWidget!.treefinder.model!),\n      icon: copyIcon,\n      label: \"Copy\",\n      isVisible: () => {\n        const widget = tracker.currentWidget;\n        if (!widget) {\n          return false;\n        }\n        // Copy of folders are unsupported\n        if (widget.treefinder.model?.selection.some(v => v.row.kind === \"dir\")) {\n          return false;\n        }\n        return true;\n      },\n      isEnabled: () => !!tracker.currentWidget,\n    }),\n    app.commands.addCommand(commandIDs.cut, {\n      execute: args => clipboard.model.cutSelection(tracker.currentWidget!.treefinder.model!),\n      icon: cutIcon,\n      label: \"Cut\",\n      isEnabled: () => currentWidgetSelectionIsWritable(tracker),\n    }),\n    app.commands.addCommand(commandIDs.delete, {\n      execute: async args => {\n        const treefinder = tracker.currentWidget!.treefinder;\n        const model = treefinder.model!;\n        const message =\n        model.selection.length === 1\n          ? `Are you sure you want to permanently delete: ${model.selection[0].name}?`\n          : `Are you sure you want to permanently delete the ${model.selection.length} selected items?`;\n        const result = await showDialog({\n          title: \"Delete\",\n          body: message,\n          buttons: [\n            Dialog.cancelButton({ label: \"Cancel\" }),\n            Dialog.warnButton({ label: \"Delete\" }),\n          ],\n          // By default focus on \"Cancel\" to protect from accidental deletion\n          defaultButton: 0,\n        });\n\n        if (!treefinder.isDisposed && result.button.accept) {\n          clipboard.model.deleteSelection(model);\n        }\n      },\n      icon: closeIcon.bindprops({ stylesheet: \"menuItem\" }),\n      label: \"Delete\",\n      isEnabled: () => currentWidgetSelectionIsWritable(tracker),\n    }),\n    app.commands.addCommand(commandIDs.open, {\n      execute: args => tracker.currentWidget!.treefinder.model!.openSub.next(tracker.currentWidget!.treefinder.selection?.map(c => c.row) || []),\n      label: \"Open\",\n      isEnabled: () => !!tracker.currentWidget,\n    }),\n\n    app.commands.addCommand(commandIDs.paste, {\n      execute: args => clipboard.model.pasteSelection(tracker.currentWidget!.treefinder.model!),\n      icon: pasteIcon,\n      label: \"Paste\",\n      isEnabled: () => !!tracker.currentWidget,\n    }),\n    app.commands.addCommand(commandIDs.rename, {\n      execute: args => {\n        const widget = tracker.currentWidget!;\n        const oldContent = widget.treefinder.selection![0];\n        void TreeFinderSidebar.doRename(widget, oldContent).then(newContent => {\n          widget.treefinder.model?.renamerSub.next( { name: newContent.name, target: oldContent } );\n          // TODO: Model state of TreeFinderWidget should be updated by renamerSub process.\n          oldContent.row = newContent;\n        });\n      },\n      icon: editIcon,\n      label: \"Rename\",\n      isEnabled: () => currentWidgetSelectionIsWritable(tracker),\n    }),\n    app.commands.addCommand(commandIDs.download, {\n      execute: async args => {\n        const widget = tracker.currentWidget!;\n        const selection = widget.treefinder.selection!;\n        await Promise.allSettled(selection.map(s => widget.download(s.pathstr, s.hasChildren)));\n      },\n      icon: downloadIcon,\n      label: \"Download\",\n      isEnabled: () => !!(\n        tracker.currentWidget?.treefinder.model?.selection?.some(s => !s.hasChildren)\n      ),\n    }),\n    app.commands.addCommand(commandIDs.createFolder, {\n      execute: async args =>  {\n        const widget = tracker.currentWidget!;\n        const model = widget.treefinder.model!;\n        let target = model.selectedLast ?? model.root;\n        if (!target.hasChildren) {\n          target = await getContentParent(target, model.root);\n        }\n        const path = Path.fromarray(target.row.path);\n        let row: ContentsProxy.IJupyterContentRow;\n        try {\n          row = await widget.treefinder.contentsProxy.newUntitled({\n            type: \"directory\",\n            path,\n          });\n        } catch (e) {\n          void showErrorMessage(\"Could not create folder\", e as string);\n          return;\n        }\n        target.invalidate();\n        const content = await revealAndSelectPath(model, row.path);\n        // Is this really needed?\n        model.refreshSub.next(getRefreshTargets([target.row], model.root) || []);\n        // Scroll into view if not visible\n        await TreeFinderSidebar.scrollIntoView(widget.treefinder, content.pathstr);\n        const newContent = await TreeFinderSidebar.doRename(widget, content);\n        model.renamerSub.next( { name: newContent.name, target: content } );\n        // TODO: Model state of TreeFinderWidget should be updated by renamerSub process.\n        content.row = newContent;\n      },\n      icon: newFolderIcon,\n      label: \"New Folder\",\n      isEnabled: () => !!tracker.currentWidget,\n    }),\n    app.commands.addCommand(commandIDs.createFile, {\n      execute: async args =>  {\n        const widget = tracker.currentWidget!;\n        const model = widget.treefinder.model!;\n        let target = model.selectedLast ?? model.root;\n        if (!target.hasChildren) {\n          target = await getContentParent(target, model.root);\n        }\n        const path = Path.fromarray(target.row.path);\n        let row: ContentsProxy.IJupyterContentRow;\n        try {\n          row = await widget.treefinder.contentsProxy.newUntitled({\n            type: \"file\",\n            path,\n          });\n        } catch (e) {\n          void showErrorMessage(\"Could not create file\", e as string);\n          return;\n        }\n        target.invalidate();\n        const content = await revealAndSelectPath(model, row.path);\n        // Is this really needed?\n        model.refreshSub.next(getRefreshTargets([target.row], model.root) || []);\n        // Scroll into view if not visible\n        await TreeFinderSidebar.scrollIntoView(widget.treefinder, content.pathstr);\n        const newContent = await TreeFinderSidebar.doRename(widget, content);\n        model.renamerSub.next( { name: newContent.name, target: content } );\n        // TODO: Model state of TreeFinderWidget should be updated by renamerSub process.\n        content.row = newContent;\n      },\n      icon: fileIcon,\n      label: \"New File\",\n      isEnabled: () => !!tracker.currentWidget,\n    }),\n    app.commands.addCommand(commandIDs.refresh, {\n      execute: args => {\n        if (args[\"selection\"]) {\n          clipboard.refreshSelection(tracker.currentWidget!.treefinder.model!);\n        } else {\n          clipboard.refresh(tracker.currentWidget!.treefinder.model);\n        }\n      },\n      icon: refreshIcon,\n      label: args => args[\"selection\"] ? \"Refresh Selection\" : \"Refresh\",\n      isEnabled: () => !!tracker.currentWidget,\n    }),\n    app.commands.addCommand(commandIDs.copyFullPath, {\n      execute: async args => {\n        const widget = tracker.currentWidget!;\n        const trimEnd = (path: string): string => path.trimEnd().replace(/\\/+$/, \"\");\n        const fullPaths = _getRelativePaths(widget.treefinder.selection!).map(relativePath => [trimEnd(widget.url ?? \"\"), relativePath].join(\"/\"));\n        await navigator.clipboard.writeText(fullPaths.join(\"\\n\"));\n      },\n      label: \"Copy Full Path\",\n      isEnabled: () => !!tracker.currentWidget,\n    }),\n    app.commands.addCommand(commandIDs.copyRelativePath, {\n      execute: async args => {\n        const widget = tracker.currentWidget!;\n        const relativePaths = _getRelativePaths(widget.treefinder.selection!);\n        await navigator.clipboard.writeText(relativePaths.join(\"\\n\"));\n      },\n      label: \"Copy Relative Path\",\n      isEnabled: () => !!tracker.currentWidget,\n    }),\n    app.commands.addCommand(commandIDs.toggleColumnPath, {\n      execute: args => { /* no-op */ },\n      label: \"path\",\n      isEnabled: () => false,\n      isToggled: () => true,\n    }),\n    app.commands.addCommand(commandIDs.restore, {\n      execute: async args => {\n        const rootPath = args.rootPath as string;\n        const dirsToOpen = rootPath.split(\"/\");\n        const sidebar = tracker.findByDrive(args.id as string);\n        if (!sidebar) {\n          throw new Error(`Could not restore JupyterFS browser: ${args.id}`);\n        }\n        const treefinderwidget = sidebar.treefinder;\n        const model = treefinderwidget.model!;\n\n        // If preferredDir not specified, proceed with the restore\n        if (!sidebar.preferredDir) {\n          await openDirRecursive(model, dirsToOpen);\n          await tracker.save(sidebar);\n        }\n      },\n    }),\n    app.commands.addCommand(commandIDs.newLauncher, {\n      execute: async args => {\n        void app.commands.execute(\"launcher:create\");\n      },\n      label: \"New Launcher\",\n      isEnabled: () => true,\n    }),\n  ].reduce((set: DisposableSet, d) => {\n    set.add(d); return set;\n  }, new DisposableSet());\n}\n\n\n/**\n * Create commands whose count/IDs depend on settings/resources\n */\nexport async function createDynamicCommands(\n  app: JupyterFrontEnd,\n  tracker: TreeFinderTracker,\n  clipboard: JupyterClipboard,\n  resources: IFSResource[],\n  settings?: ISettingRegistry.ISettings,\n): Promise<IDisposable> {\n  const columnCommands = [];\n  const toggleState: {[key: string]: boolean} = {};\n  const colsToDisplay = settings?.composite.display_columns as string[] ?? [\"size\"];\n  const columnsMenu = new Menu({ commands: app.commands });\n  columnsMenu.title.label = \"Show/Hide Columns\";\n  columnsMenu.title.icon = filterListIcon;\n  columnsMenu.addItem({ command: commandIDs.toggleColumnPath });\n  for (const column of COLUMN_NAMES) {\n    columnsMenu.addItem({ command: toggleColumnCommandId(column) });\n    toggleState[column] = colsToDisplay.includes(column);\n    columnCommands.push(app.commands.addCommand(toggleColumnCommandId(column), {\n      execute: async args => {\n        toggleState[column] = !toggleState[column];\n        await settings?.set(\"display_columns\", COLUMN_NAMES.filter(k => toggleState[k]));\n      },\n      label: column,\n      isToggleable: true,\n      isToggled: () => toggleState[column],\n    }));\n  }\n\n\n  const snippetsMenu = new Menu({ commands: app.commands });\n  snippetsMenu.title.label = \"Snippets\";\n  const snippets = await getAllSnippets(settings);\n  const snippetCommands = [] as IDisposable[];\n  const snippetIds = new Set<string>();\n  for (const snippet of snippets) {\n    const key = await _commandKeyForSnippet(snippet);\n    if (snippetIds.has(key)) {\n      console.warn(\"Discarding duplicate snippet\", snippet);\n      continue;\n    }\n    snippetIds.add(key);\n    snippetsMenu.addItem({ command: key });\n    snippetCommands.push(app.commands.addCommand(key, {\n      execute: async (args: unknown) => {\n        const sidebar = tracker.currentWidget!;\n        const content = sidebar.treefinder.selection![0];\n        const instantiated = instantiateSnippet(snippet.template, sidebar.url, sidebar.type, content.pathstr);\n        await navigator.clipboard.writeText(instantiated);\n      },\n      label: snippet.label,\n      caption: snippet.caption,\n      isVisible: () => {\n        const sidebar = tracker.currentWidget;\n        const selection = sidebar?.treefinder.selection;\n        // discard if not for backend type\n        if (snippet.type !== \"\" && snippet.type !== sidebar?.type) {\n          return false;\n        }\n        // include if matches pattern\n        if (selection?.length) {\n          return snippet.pattern.test(_normalizedUrlForSnippet(selection[0], sidebar!.url));\n        }\n        return false;\n      },\n    }));\n  }\n\n  const openWithCommands = [] as IDisposable[];\n  const openWithMenu = new Menu({ commands: app.commands });\n  openWithMenu.title.label = \"Open With\";\n  openWithMenu.id = \"treefinder:open-with\";\n  const { docRegistry } = app;\n\n  let items: IDisposableMenuItem[] = [];\n\n  function updateOpenWithMenu(contextMenu: ContextMenu) {\n    const openWith =\n      (contextMenu.menu.items.find(\n        item =>\n          item.type === \"submenu\" &&\n          item.submenu?.id === \"treefinder:open-with\"\n      )?.submenu as RankedMenu) ?? null;\n\n    if (!openWith) {\n      return; // Bail early if the open with menu is not displayed\n    }\n\n    // clear the current menu items\n    // items.forEach(item => item.dispose());\n    items.length = 0;\n    // Ensure that the menu is empty\n    openWith.clearItems();\n\n    // clear the commands\n    openWithCommands.forEach(item => item.dispose());\n    openWithCommands.length = 0;\n\n    // get the widget factories that could be used to open all of the items\n    // in the current filebrowser selection\n    const widget = tracker.currentWidget!;\n    const treefinder = widget.treefinder;\n    const model = treefinder.model!;\n    const factories = tracker.currentWidget\n      ? intersection<DocumentRegistry.WidgetFactory>(\n        map(model.selection, i => getFactories(docRegistry, widget, i))\n      )\n      : new Set<DocumentRegistry.WidgetFactory>();\n\n    // make new menu items from the widget factories\n    items = [...factories].map(factory => {\n      const key = _openWithKeyForFactory(factory.label || factory.name);\n      const label = factory.label || factory.name;\n      if (!app.commands.hasCommand(key)) {\n        openWithCommands.push(app.commands.addCommand(key, {\n          execute: args => Promise.all(Array.from(map(model.selection, item => app.commands.execute(\"docmanager:open\", { path: Path.fromarray(item.row.path), ...args })))),\n          label,\n          isVisible: () => true,\n        }));\n      } else {\n        // Update label in case it has changed\n        // eslint-disable-next-line no-console\n        console.log(\"Skipping existing command:\", key);\n      }\n      return openWith.addItem({\n        args: { factory: factory.name, label: factory.label || factory.name },\n        command: key,\n      });\n    });\n  }\n  app.contextMenu.opened.connect(updateOpenWithMenu);\n\n  const selector = \".jp-tree-finder-sidebar\";\n  let contextMenuRank = 1;\n\n  return [\n    ...columnCommands,\n    ...snippetCommands,\n\n    // context menu items\n    app.contextMenu.addItem({\n      command: commandIDs.open,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      type: \"submenu\",\n      submenu: openWithMenu,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      command: commandIDs.copy,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      command: commandIDs.cut,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      command: commandIDs.paste,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      command: commandIDs.delete,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      command: commandIDs.rename,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      command: commandIDs.download,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      type: \"separator\",\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      command: commandIDs.copyFullPath,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      command: commandIDs.copyRelativePath,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      type: \"submenu\",\n      submenu: snippetsMenu,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      type: \"separator\",\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      command: commandIDs.createFile,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      command: commandIDs.createFolder,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      type: \"separator\",\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      type: \"submenu\",\n      submenu: columnsMenu,\n      selector,\n      rank: contextMenuRank++,\n    }),\n    app.contextMenu.addItem({\n      args: { selection: true },\n      command: commandIDs.refresh,\n      selector,\n      rank: contextMenuRank++,\n    }),\n  ].reduce((set: DisposableSet, d) => {\n    set.add(d); return set;\n  }, new DisposableSet());\n}\n\n\nexport function getFactories(\n  docRegistry: DocumentRegistry,\n  widget: TreeFinderSidebar,\n  item: Content<ContentsProxy.IJupyterContentRow>,\n): DocumentRegistry.WidgetFactory[] {\n  const path = [widget.url.trimEnd().replace(/\\/+$/, \"\"), item.getPathAtDepth(1).join(\"/\")].join(\"/\");\n  const factories = docRegistry.preferredWidgetFactories(path);\n  const notebookFactory = docRegistry.getWidgetFactory(\"notebook\");\n  if (\n    notebookFactory &&\n    item.row.kind === \"notebook\" &&\n    factories.indexOf(notebookFactory) === -1\n  ) {\n    factories.unshift(notebookFactory);\n  }\n  return factories;\n}\n\nfunction intersection<T>(iterables: Iterable<Iterable<T>>): Set<T> {\n  let accumulator: Set<T> | undefined;\n  for (const current of iterables) {\n    // Initialize accumulator.\n    if (accumulator === undefined) {\n      accumulator = new Set(current);\n      continue;\n    }\n    // Return early if empty.\n    if (accumulator.size === 0) {\n      return accumulator;\n    }\n    // Keep the intersection of accumulator and current.\n    const intersection_set = new Set<T>();\n    for (const value of current) {\n      if (accumulator.has(value)) {\n        intersection_set.add(value);\n      }\n    }\n    accumulator = intersection_set;\n  }\n  return accumulator ?? new Set();\n}\n","\n\nimport { PromiseDelegate } from \"@lumino/coreutils\";\nimport { showErrorMessage } from \"@jupyterlab/apputils\";\nimport { Contents } from \"@jupyterlab/services\";\nimport { IContentRow, Path } from \"@tree-finder/base\";\n\n\n/**\n * Wrapper for a drive onto the contents manager.\n */\nexport class ContentsProxy {\n  constructor(contentsManager: Contents.IManager, drive?: string, onGetChildren?: ContentsProxy.GetChildrenCallback) {\n    this.contentsManager = contentsManager;\n    this.drive = drive;\n    this.onGetChildren = onGetChildren;\n  }\n\n  async get(path: string, options?: Contents.IFetchOptions) {\n    path = ContentsProxy.toFullPath(path, this.drive);\n    return ContentsProxy.toJupyterContentRow(await this.contentsManager.get(path, options), this.contentsManager, this.drive, this.onGetChildren);\n  }\n\n  async save(path: string, options?: Partial<Contents.IModel>) {\n    path = ContentsProxy.toFullPath(path, this.drive);\n    return ContentsProxy.toJupyterContentRow(await this.contentsManager.save(path, options), this.contentsManager, this.drive, this.onGetChildren);\n  }\n\n  async rename(path: string, newPath: string) {\n    path = ContentsProxy.toFullPath(path, this.drive);\n    newPath = ContentsProxy.toFullPath(newPath, this.drive);\n    return ContentsProxy.toJupyterContentRow(await this.contentsManager.rename(path, newPath), this.contentsManager, this.drive, this.onGetChildren);\n  }\n\n  async newUntitled(options: Contents.ICreateOptions) {\n    options.path = options.path && ContentsProxy.toFullPath(options.path, this.drive);\n    return ContentsProxy.toJupyterContentRow(await this.contentsManager.newUntitled(options), this.contentsManager, this.drive, this.onGetChildren);\n  }\n\n  async downloadUrl(path: string) {\n    path = ContentsProxy.toFullPath(path, this.drive);\n    return await this.contentsManager.getDownloadUrl(path);\n  }\n\n  readonly contentsManager: Contents.IManager;\n  readonly drive?: string;\n  readonly onGetChildren?: ContentsProxy.GetChildrenCallback;\n}\n\nexport namespace ContentsProxy {\n  export interface IJupyterContentRow extends Omit<Contents.IModel, \"path\" | \"content\" | \"type\">, IContentRow {}\n\n  export type GetChildrenCallback = (path: string, done: Promise<void>) => void;\n\n  export function toFullPath(path: string, drive?: string): string {\n\n    if (!drive || path.startsWith(`${drive}:`)) {\n      if (path.startsWith(`${drive}:/`)) {\n        return path.replace(`${drive}:/`, `${drive}:`);\n      }\n      return path;\n    } else if (path.startsWith(`${drive}/`)) {\n      return [drive, path.slice(drive.length + 1)].join(\":\");\n    } else {\n      return [drive, path].join(\":\");\n    }\n  }\n\n  export function toLocalPath(path: string): string {\n    const [first, ...rest] = path.split(\"/\");\n    return [first.split(\":\").pop(), ...rest].join(\"/\");\n  }\n\n  export function toJupyterContentRow(row: Contents.IModel, contentsManager: Contents.IManager, drive?: string, onGetChildren?: ContentsProxy.GetChildrenCallback): IJupyterContentRow {\n    const { path, type, ...rest } = row;\n\n    const pathWithDrive = toFullPath(path, drive).replace(/\\/$/, \"\");\n    const kind = type === \"directory\" ? \"dir\" : type;\n\n    return {\n      path: Path.toarray(pathWithDrive),\n      kind,\n      ...rest,\n      ...(kind === \"dir\" ? {\n        getChildren: async () => {\n          let contents: Contents.IModel;\n          const done = new PromiseDelegate<void>();\n          if (onGetChildren) {\n            const pathstr = Path.toarray(pathWithDrive).join(\"/\");  // maybe clean up the different path formats we have...\n            onGetChildren(pathstr, done.promise);\n          }\n\n          try {\n            contents = await contentsManager.get(pathWithDrive, { content: true });\n            done.resolve();\n          } catch (error) {\n            void showErrorMessage(\"Failed to get directory contents\", error as string);\n            done.reject(\"Failed to get directory contents\");\n            return [];\n          }\n          return (contents.content as Contents.IModel[]).map(c => toJupyterContentRow(c, contentsManager, drive, onGetChildren));\n        },\n      }: {}),\n    };\n  }\n}\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\n\nimport { Content, ContentsModel, IContentRow } from \"@tree-finder/base\";\n\n/**\n * Utilities for manipulating the tree-finder contents model\n */\n\n/**\n * Walk the path from root, yielding all rows along the way\n *\n * @param path The path to walk to\n * @param root The root to start from\n */\nasync function* walkPath<T extends IContentRow>(path: string[], root: Content<T>) {\n  // Walk the path from the root\n  const pathstr = path.join(\"/\");\n  if (!pathstr.startsWith(root.pathstr)) {\n    throw new Error(`Path ${pathstr} not in ${root.pathstr}`);\n  }\n  let node = root;\n  yield node;\n  for (let i=root.row.path.length; i<path.length; ++i) {\n    const children = await node.getChildren();\n    const child = children?.find(c => c.name === path[i]);\n    if (!child) {\n      throw new Error(`Path ${pathstr} not in ${node.pathstr}`);\n    }\n    node = child;\n    yield node;\n  }\n}\n\n\n/**\n * Expand the contents nodes until path is exposed.\n *\n * This means that even if the final element of the path is a directory, its expanded state will\n * not change.\n *\n * @param contents The contents model that the path is in\n * @param path The path to expose, relative to the root (i.e. first entry matches path of root)\n */\nexport async function revealPath<T extends IContentRow>(contents: ContentsModel<T>, path: string[]): Promise<Content<T>> {\n  let node: Content<T>;\n  const promises: Array<Promise<void>> = [];\n  for await (node of walkPath(path, contents.root)) {\n    if (!node.isExpand && node.hasChildren) {\n      promises.push(node.expand());\n    }\n  }\n  await Promise.all(promises);\n  return node!;\n}\n\n\n/**\n * Expand the contents nodes until path is exposed, and select the node of that path.\n *\n * This means that even if the final element of the path is a directory, its expanded state will\n * not change.\n *\n * @param contents The contents model that the path is in\n * @param path The path to expose, relative to the root (i.e. first entry matches path of root)\n * @param add Whether or not to add the path to the current selection, or to replace the current selection @see TreeFinder.SelectionModel.select\n */\nexport async function revealAndSelectPath<T extends IContentRow>(contents: ContentsModel<T>, path: string[], add?: boolean): Promise<Content<T>> {\n  const node = await revealPath(contents, path);\n  contents.selectionModel.select(node, add);\n  return node;\n}\n\n\n/**\n * Recursively opens directories in a contents model\n *\n * @param model The contents model where directories are to be opened\n * @param path Array of directory names to be opened in order\n */\nexport async function openDirRecursive<T extends IContentRow>(model: ContentsModel<T>, path: string[]) {\n  const promises: Array<Promise<void>> = [];\n  for await (const node of walkPath(path, model.root)) {\n    if (node.pathstr !== model.root.pathstr) {\n      promises.push(model.openDir(node.row));\n    }\n  }\n  await Promise.all(promises);\n}\n\n\n/**\n * Get the parent contents row for the given contents row.\n *\n * Note: This will cause contents API calls if any dir has been invalidated between root and the parent.\n *\n * @param child The content node's whose parent we are looking for\n * @param root The root node of the path\n */\nexport async function getContentParent<T extends IContentRow>(child: Content<T>, root: Content<T>) {\n  // Walk from the root to the parent\n  let node: Content<T>;\n  for await (node of walkPath(child.row.path.slice(0, -1), root)) {\n    // no-op\n  }\n  return node!;\n}\n\n\n/**\n * Get targets to use for a call to tree-finder's refresh\n *\n * @param invalidateTargets The targets that need to be refreshed\n * @param root The root node of the contents tree\n * @param targetParents Whether the parents are the ones that should be invalidated\n * @returns\n */\nexport function getRefreshTargets<T extends IContentRow>(\n  invalidateTargets: T[],\n  root: Content<T>,\n  targetParents=false\n): T[] | undefined {\n  const rootRefreshThreshold = root.row.path.length + (targetParents ? 1 : 0);\n  const rootNeedsRefresh = invalidateTargets.some(\n    t => t.path.length <= rootRefreshThreshold + (t.getChildren ? 0 : 1)\n  );\n  if (rootNeedsRefresh) {\n    return undefined;\n  }\n  if (targetParents) {\n    // tree-finder doesn't correctly refresh parents of folders, so we work around it for now\n    // (in more detail, tree-finder will only refresh the folder if the entry does not have a\n    // getChildren entry, go figure...)\n    return invalidateTargets.map(t => ({ ...t, getChildren: undefined }));\n  }\n  return invalidateTargets;\n}\n\n\n/**\n * Split a \"pathstr\" into its drive and path components\n */\nexport function splitPathstrDrive(pathstr: string): [string, string] {\n  const splitloc = pathstr.indexOf(\"/\");\n  if (splitloc === -1) {\n    return [pathstr, \"\"];\n  }\n  // split, and trim leading forward slashes on the path component\n  return [pathstr.slice(0, splitloc), pathstr.slice(splitloc + 1).replace(/^[/]*/, \"\")];\n}\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\n/*\nOriginally copied from jupyter's nbdime package, under the following license terms:\n\nThis project is licensed under the terms of the Modified BSD License\n(also known as New or Revised or 3-Clause BSD), as follows:\n\n- Copyright (c) 2001-2015, IPython Development Team\n- Copyright (c) 2015-, Jupyter Development Team\n\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\nRedistributions of source code must retain the above copyright notice, this\nlist of conditions and the following disclaimer.\n\nRedistributions in binary form must reproduce the above copyright notice, this\nlist of conditions and the following disclaimer in the documentation and/or\nother materials provided with the distribution.\n\nNeither the name of the Jupyter Development Team nor the names of its\ncontributors may be used to endorse or promote products derived from this\nsoftware without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE\nFOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\nSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\nCAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\nOR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\n## About the Jupyter Development Team\n\nThe Jupyter Development Team is the set of all contributors to the Jupyter project.\nThis includes all of the Jupyter subprojects.\n\nThe core team that coordinates development on GitHub can be found here:\nhttps://github.com/jupyter/.\n*/\n\n\"use strict\";\n\nimport {\n  Widget,\n} from \"@lumino/widgets\";\n\nimport type {\n  Message,\n} from \"@lumino/messaging\";\n\nimport {\n  MimeData,\n} from \"@lumino/coreutils\";\n\nimport {\n  Drag,\n} from \"@lumino/dragdrop\";\n\n\n/**\n * The class name added to the DropWidget\n */\nconst DROP_WIDGET_CLASS = \"jfs-DropWidget\";\n\n/**\n * The class name added to the DragWidget\n */\nconst DRAG_WIDGET_CLASS = \"jfs-DragWidget\";\n\n/**\n * The class name added to something which can be used to drag a box\n */\nconst DRAG_HANDLE = \"jfs-mod-dragHandle\";\n\n/**\n * The class name of the default drag handle\n */\nconst DEFAULT_DRAG_HANDLE_CLASS = \"jfs-DragWidget-dragHandle\";\n\n/**\n * The class name added to a drop target.\n */\nconst DROP_TARGET_CLASS = \"jfs-mod-dropTarget\";\n\n/**\n * The threshold in pixels to start a drag event.\n */\nconst DRAG_THRESHOLD = 5;\n\n/**\n * The mime type for a table header drag object.\n */\nexport const TABLE_HEADER_MIME = \"application/x-jupyterfs-thead\";\n\n\n/**\n * Determine whether node is equal to or a descendant of our widget, and that it does\n * not belong to a nested drag widget.\n */\nexport\nfunction belongsToUs(node: HTMLElement, parentClass: string,\n  parentNode: HTMLElement): boolean {\n  let candidate: HTMLElement | null = node;\n  // Traverse DOM until drag widget encountered:\n  while (candidate && !candidate.classList.contains(parentClass)) {\n    candidate = candidate.parentElement;\n  }\n  return !!candidate && candidate === parentNode;\n}\n\n\n/**\n * Find the direct child node of `parent`, which has `node` as a descendant.\n * Alternatively, parent can be a collection of children.\n *\n * Returns null if not found.\n */\nexport\nfunction findChild(parent: HTMLElement | HTMLElement[], node: HTMLElement): HTMLElement | null  {\n  // Work our way up the DOM to an element which has this node as parent\n  const parentIsArray = Array.isArray(parent);\n  const isDirectChild = (element: HTMLElement): boolean => {\n    if (parentIsArray) {\n      return parent.indexOf(element) > -1;\n    } else {\n      return element.parentElement === parent;\n    }\n  };\n  let candidate: HTMLElement | null = node;\n  let child: HTMLElement | null = null;\n  while (candidate && candidate !== parent) {\n    if (isDirectChild(candidate)) {\n      child = candidate;\n      break;\n    }\n    candidate = candidate.parentElement;\n  }\n  return child;\n}\n\n\n/**\n * A widget class which allows the user to drop mime data onto it.\n *\n * To complete the class, the following functions need to be implemented:\n *  - processDrop: Process pre-screened drop events\n *\n * The functionallity of the class can be extended by overriding the following\n * functions:\n *  - findDropTarget(): Override if anything other than the direct children\n *    of the widget's node are to be the drop targets.\n *\n * For maximum control, `evtDrop` can be overriden.\n */\nexport\nabstract class DropWidget extends Widget {\n  /**\n   * Construct a drop widget.\n   */\n  constructor(options: DropWidget.IOptions={}) {\n    super(options);\n    this.acceptDropsFromExternalSource =\n      options.acceptDropsFromExternalSource === true;\n    this.addClass(DROP_WIDGET_CLASS);\n    this.acceptedDropMimeTypes = options.acceptedDropMimeTypes ?? [];\n  }\n\n  /**\n   * Whether the widget should accept drops from an external source,\n   * or only accept drops from itself.\n   * Defaults to false, which will disallow all drops unless widget\n   * is also a drag widget.\n   */\n  acceptDropsFromExternalSource: boolean;\n\n\n  /**\n   * Which mimetypes that the widget accepts for drops\n   */\n  acceptedDropMimeTypes: string[];\n\n\n  /**\n   * Handle the DOM events for the widget.\n   *\n   * @param event - The DOM event sent to the widget.\n   *\n   * #### Notes\n   * This method implements the DOM `EventListener` interface and is\n   * called in response to events on the drop widget's node. It should\n   * not be called directly by user code.\n   */\n  handleEvent(event: Event): void {\n    switch (event.type) {\n      case \"lm-dragenter\":\n        this._evtDragEnter(event as Drag.Event);\n        break;\n      case \"lm-dragleave\":\n        this._evtDragLeave(event as Drag.Event);\n        break;\n      case \"lm-dragover\":\n        this._evtDragOver(event as Drag.Event);\n        break;\n      case \"lm-drop\":\n        this.evtDrop(event as Drag.Event);\n        break;\n      default:\n        break;\n    }\n  }\n\n  protected validateSource(event: Drag.Event) {\n    return this.acceptDropsFromExternalSource || event.source === this;\n  }\n\n  /**\n   * Processes a drop event.\n   *\n   * This function is called after checking:\n   *  - That the `dropTarget` is a valid drop target\n   *  - The value of `event.source` if `acceptDropsFromExternalSource` is false\n   */\n  protected abstract processDrop(dropTarget: HTMLElement, event: Drag.Event): void;\n\n  /**\n   * Find a drop target from a given drag event target.\n   *\n   * Returns null if no valid drop target was found.\n   *\n   * The default implementation returns the direct child that is the parent of\n   * `node`, or `node` if it is itself a direct child. It also checks that the\n   * needed mime type is included\n   */\n  protected findDropTarget(input: HTMLElement, mimeData: MimeData): HTMLElement | null  {\n    if (!this.acceptedDropMimeTypes.some(mimetype => mimeData.hasData(mimetype))) {\n      return null;\n    }\n\n    if (this._isValidTargetHeader(input, mimeData.getData(TABLE_HEADER_MIME) as string)) {\n      input.classList.add(DROP_TARGET_CLASS);\n    } else {\n      return null;\n    }\n\n    // No need to findChild for reordering of columns\n    if (mimeData.types().includes(TABLE_HEADER_MIME)) {\n      return input;\n    } else {\n      return findChild(this.node, input);\n    }\n  }\n\n  /**\n   * Handle the `'lm-drop'` event for the widget.\n   *\n   * Responsible for pre-processing event before calling `processDrop`.\n   *\n   * Should normally only be overriden if you cannot achive your goal by\n   * other overrides.\n   */\n  protected evtDrop(event: Drag.Event): void {\n    let target = event.target as HTMLElement;\n    while (target && target.parentElement) {\n      if (target.classList.contains(DROP_TARGET_CLASS)) {\n        target.classList.remove(DROP_TARGET_CLASS);\n        break;\n      }\n      target = target.parentElement;\n    }\n    if (!target || !belongsToUs(target, DROP_WIDGET_CLASS, this.node)) {\n      // Ignore event\n      return;\n    }\n\n    // If configured to, only accept internal moves:\n    if (!this.validateSource(event)) {\n      event.dropAction = \"none\";\n      event.preventDefault();\n      event.stopPropagation();\n      return;\n    }\n\n    this.processDrop(target, event);\n  }\n\n  /**\n   * Handle `after_attach` messages for the widget.\n   */\n  protected onAfterAttach(msg: Message): void {\n    const node = this.node;\n    node.addEventListener(\"lm-dragenter\", this);\n    node.addEventListener(\"lm-dragleave\", this);\n    node.addEventListener(\"lm-dragover\", this);\n    node.addEventListener(\"lm-drop\", this);\n  }\n\n  /**\n   * Handle `before_detach` messages for the widget.\n   */\n  protected onBeforeDetach(msg: Message): void {\n    const node = this.node;\n    node.removeEventListener(\"lm-dragenter\", this);\n    node.removeEventListener(\"lm-dragleave\", this);\n    node.removeEventListener(\"lm-dragover\", this);\n    node.removeEventListener(\"lm-drop\", this);\n  }\n\n\n  /**\n   * Handle the `'lm-dragenter'` event for the widget.\n   */\n  private _evtDragEnter(event: Drag.Event): void {\n    if (!this.validateSource(event)) {\n      return;\n    }\n    const target = this.findDropTarget(event.target as HTMLElement, event.mimeData);\n    if (target === null) {\n      return;\n    }\n    this._clearDropTarget();\n    target.classList.add(DROP_TARGET_CLASS);\n    event.preventDefault();\n    event.stopPropagation();\n  }\n\n  /**\n   * Handle the `'lm-dragleave'` event for the widget.\n   */\n  private _evtDragLeave(event: Drag.Event): void {\n    event.preventDefault();\n    event.stopPropagation();\n    this._clearDropTarget();\n  }\n\n  /**\n   * Handle the `'lm-dragover'` event for the widget.\n   */\n  private _evtDragOver(event: Drag.Event): void {\n    if (!this.validateSource(event)) {\n      return;\n    }\n    this._clearDropTarget();\n    const target = this.findDropTarget(event.target as HTMLElement, event.mimeData);\n    if (target === null) {\n      return;\n    }\n    event.preventDefault();\n    event.stopPropagation();\n    event.dropAction = event.proposedAction;\n  }\n\n  /**\n   * Checks if the target is a header, and it is not 'path' or itself\n   */\n  private _isValidTargetHeader(target: HTMLElement, draggedColumn: string) {\n    return target.classList.contains(\"tf-header-name\") &&\n            target.innerText !== draggedColumn &&\n            target.innerText !== \"path\";\n  }\n\n  /**\n   * Clear existing drop target from out children.\n   *\n   * #### Notes\n   * This function assumes there are only one active drop target\n   */\n  private _clearDropTarget(): void {\n    const elements = this.node.getElementsByClassName(DROP_TARGET_CLASS);\n    if (elements.length) {\n      (elements[0] as HTMLElement).classList.remove(DROP_TARGET_CLASS);\n    }\n  }\n}\n\n/**\n * An internal base class for implementing drag operations on top\n * of drop class.\n */\nexport\nabstract class DragDropWidgetBase extends DropWidget {\n\n  /**\n   * Construct a drag and drop base widget.\n   */\n  constructor(options: DragDropWidget.IOptions={}) {\n    super(options);\n    this.addClass(DRAG_WIDGET_CLASS);\n  }\n\n  /**\n   * Dispose of the resources held by the directory listing.\n   */\n  dispose(): void {\n    this.drag = null;\n    this._clickData = null;\n    super.dispose();\n  }\n\n  /**\n   * Handle the DOM events for the widget.\n   *\n   * @param event - The DOM event sent to the widget.\n   *\n   * #### Notes\n   * This method implements the DOM `EventListener` interface and is\n   * called in response to events on the drag widget's node. It should\n   * not be called directly by user code.\n   */\n  handleEvent(event: Event): void {\n    switch (event.type) {\n      case \"mousedown\":\n        this._evtDragMousedown(event as MouseEvent);\n        break;\n      case \"mouseup\":\n        this._evtDragMouseup(event as MouseEvent);\n        break;\n      case \"mousemove\":\n        this._evtDragMousemove(event as MouseEvent);\n        break;\n      default:\n        super.handleEvent(event);\n        break;\n    }\n  }\n\n  /**\n   * Adds mime data representing the drag data to the drag event's MimeData bundle.\n   */\n  protected abstract addMimeData(handle: HTMLElement, mimeData: MimeData): void;\n\n  /**\n   * Finds the drag target (the node to move) from a drag handle.\n   *\n   * Returns null if no valid drag target was found.\n   *\n   * The default implementation returns the handle directly.\n   */\n  protected findDragTarget(handle: HTMLElement): HTMLElement | null {\n    return handle;\n  }\n\n  /**\n   * Returns the drag image to use when dragging using the given handle.\n   *\n   * The default implementation returns a clone of the drag target.\n   */\n  protected getDragImage(handle: HTMLElement): HTMLElement | null {\n    const target = this.findDragTarget(handle);\n    if (target) {\n      return target.cloneNode(true) as HTMLElement;\n    }\n    return null;\n  }\n\n  /**\n   * Called when a drag has completed with this widget as a source\n   */\n  protected onDragComplete(action: Drag.DropAction) {\n    this.drag = null;\n  }\n\n  /**\n   * Handle `after_attach` messages for the widget.\n   */\n  protected onAfterAttach(msg: Message): void {\n    const node = this.node;\n    node.addEventListener(\"mousedown\", this);\n    super.onAfterAttach(msg);\n  }\n\n  /**\n   * Handle `before_detach` messages for the widget.\n   */\n  protected onBeforeDetach(msg: Message): void {\n    const node = this.node;\n    node.removeEventListener(\"click\", this);\n    node.removeEventListener(\"dblclick\", this);\n    document.removeEventListener(\"mousemove\", this, true);\n    document.removeEventListener(\"mouseup\", this, true);\n    super.onBeforeDetach(msg);\n  }\n\n  /**\n   * Start a drag event.\n   *\n   * Called when dragging and DRAG_THRESHOLD is met.\n   *\n   * Should normally only be overriden if you cannot achieve your goal by\n   * other overrides.\n   */\n  protected startDrag(handle: HTMLElement, clientX: number, clientY: number): void {\n    // Create the drag image.\n    const dragImage = this.getDragImage(handle);\n\n    // Set up the drag event.\n    this.drag = new Drag({\n      dragImage: dragImage || undefined,\n      mimeData: new MimeData(),\n      supportedActions: this.defaultSupportedActions,\n      proposedAction: this.defaultProposedAction,\n      source: this,\n    });\n    this.addMimeData(handle, this.drag.mimeData);\n\n    // Start the drag and remove the mousemove listener.\n    void this.drag.start(clientX, clientY).then(action => this.onDragComplete(action));\n    document.removeEventListener(\"mousemove\", this, true);\n    document.removeEventListener(\"mouseup\", this, true);\n  }\n\n  /**\n   * Drag data stored in _startDrag\n   */\n  protected drag: Drag | null = null;\n\n  protected dragHandleClass = DRAG_HANDLE;\n\n  /**\n   * Check if node, or any of nodes ancestors are a drag handle\n   *\n   * If it is a drag handle, it returns the handle, if not returns null.\n   */\n  private _findDragHandle(node: HTMLElement): HTMLElement | null {\n    let handle: HTMLElement | null = null;\n    // Traverse up DOM to check if click is on a drag handle\n    let candidate: HTMLElement | null = node;\n    while (candidate && candidate !== this.node) {\n      if (candidate.classList.contains(this.dragHandleClass)) {\n        handle = candidate;\n        break;\n      }\n      candidate = candidate.parentElement;\n    }\n    // Finally, check that handle does not belong to a nested drag widget\n    if (handle !== null && !belongsToUs(\n      handle, DRAG_WIDGET_CLASS, this.node)) {\n      // Handle belongs to a nested drag widget:\n      handle = null;\n    }\n    return handle;\n  }\n\n  /**\n   * Handle the `'mousedown'` event for the widget.\n   */\n  private _evtDragMousedown(event: MouseEvent): void {\n    const target = event.target as HTMLElement;\n    const handle = this._findDragHandle(target);\n    if (handle === null) {\n      return;\n    }\n\n    // Left mouse press for drag start.\n    if (event.button === 0) {\n      this._clickData = { pressX: event.clientX, pressY: event.clientY,\n        handle };\n      document.addEventListener(\"mouseup\", this, true);\n      document.addEventListener(\"mousemove\", this, true);\n      event.preventDefault();\n    }\n  }\n\n\n  /**\n   * Handle the `'mouseup'` event for the widget.\n   */\n  private _evtDragMouseup(event: MouseEvent): void {\n    if (event.button !== 0 || !this.drag) {\n      document.removeEventListener(\"mousemove\", this, true);\n      document.removeEventListener(\"mouseup\", this, true);\n      this.drag = null;\n      return;\n    }\n    event.preventDefault();\n    event.stopPropagation();\n  }\n\n  /**\n   * Handle the `'mousemove'` event for the widget.\n   */\n  private _evtDragMousemove(event: MouseEvent): void {\n    // Bail if we are already dragging.\n    if (this.drag) {\n      return;\n    }\n\n    event.preventDefault();\n    event.stopPropagation();\n\n    // Check for a drag initialization.\n    const data = this._clickData;\n    if (!data) {\n      throw new Error(\"Missing drag data\");\n    }\n    const dx = Math.abs(event.clientX - data.pressX);\n    const dy = Math.abs(event.clientY - data.pressY);\n    if (dx < DRAG_THRESHOLD && dy < DRAG_THRESHOLD) {\n      return;\n    }\n\n    this.startDrag(data.handle, event.clientX, event.clientY);\n    this._clickData = null;\n  }\n\n  protected defaultSupportedActions: Drag.SupportedActions = \"all\";\n  protected defaultProposedAction: Drag.DropAction = \"move\";\n\n  /**\n   * Data stored on mouse down to determine if drag treshold has\n   * been overcome, and to initialize drag once it has.\n   */\n  private _clickData: { pressX: number, pressY: number, handle: HTMLElement } | null = null;\n}\n\n/**\n * A widget which allows the user to initiate drag operations.\n *\n * Any descendant element with the drag handle class `'jfs-mod-dragHandle'`\n * will serve as a handle that can be used for dragging. If DragWidgets are\n * nested, handles will only belong to the closest parent DragWidget. For\n * convenience, the functions `makeHandle`, `unmakeHandle` and\n * `createDefaultHandle` can be used to indicate which elements should be\n * made handles. `createDefaultHandle` will create a new element as a handle\n * with a default styling class applied. Optionally, `childrenAreDragHandles`\n * can be set to indicate that all direct children are themselve drag handles.\n *\n * To complete the class, the following functions need to be implemented:\n * - addMimeData: Adds mime data to new drag events\n *\n * The functionallity of the class can be extended by overriding the following\n * functions:\n *  - findDragTarget(): Override if anything other than the direct children\n *    of the widget's node are to be drag targets.\n *  - getDragImage: Override to change the drag image (the default is a\n *    copy of the drag target).\n *  - onDragComplete(): Callback on drag source when a drag has completed.\n */\nexport\nabstract class DragWidget extends DragDropWidgetBase {\n  /**\n   * Construct a drag widget.\n   */\n  constructor(options: DragWidget.IOptions={}) {\n    // Implementation removes DropWidget options\n    super(options);\n  }\n\n  /**\n   * No-op on DragWidget, as it does not support dropping\n   */\n  protected processDrop(dropTarget: HTMLElement, event: Drag.Event): void {\n    // Intentionally empty\n  }\n\n  /**\n   * Simply returns null for DragWidget, as it does not support dropping\n   */\n  protected findDropTarget(input: HTMLElement, mimeData: MimeData): HTMLElement | null {\n    return null;\n  }\n\n}\n\n\n/**\n * A widget which allows the user to rearrange widgets in the widget by\n * drag and drop. An internal drag and drop of a widget will cause it\n * to be inserted (by `insertWidget`) in the index of the widget it was\n * dropped on.\n *\n * Any descendant element with the drag handle class `'jfs-mod-dragHandle'`\n * will serve as a handle that can be used for dragging. If DragWidgets are\n * nested, handles will only belong to the closest parent DragWidget. For\n * convenience, the functions `makeHandle`, `unmakeHandle` and\n * `createDefaultHandle` can be used to indicate which elements should be\n * made handles. `createDefaultHandle` will create a new element as a handle\n * with a default styling class applied. Optionally, `childrenAreDragHandles`\n * can be set to indicate that all direct children are themselve drag handles.\n *\n * The functionallity of the class can be extended by overriding the following\n * functions:\n *  - addMimeData: Override to add other drag data to the mime bundle.\n *    This is often a necessary step for allowing dragging to external\n *    drop targets.\n *  - processDrop: Override if you need to handle other mime data than the\n *    default. For allowing drops from external sources, the field\n *    `acceptDropsFromExternalSource` should be set as well.\n *  - findDragTarget(): Override if anything other than the direct children\n *    of the widget's node are to be drag targets.\n *  - findDropTarget(): Override if anything other than the direct children\n *    of the widget's node are to be the drop targets.\n *  - getIndexOfChildNode(): Override to change the key used to represent\n *    the drag and drop target (default is index of child widget).\n *  - move(): Override to change how a move is handled.\n *  - getDragImage: Override to change the drag image (the default is a\n *    copy of the drag target).\n *  - onDragComplete(): Callback on drag source when a drag has completed.\n *\n * To drag and drop other things than all direct children, the following functions\n * should be overriden: `findDragTarget`, `findDropTarget` and possibly\n * `getIndexOfChildNode` and `move` to allow for custom to/from keys.\n *\n * For maximum control, `startDrag` and `evtDrop` can be overriden.\n */\nexport abstract class DragDropWidget extends DragDropWidgetBase {\n  protected abstract move(mimeData: MimeData, target: HTMLElement): Drag.DropAction;\n\n  /**\n   * Adds mime data represeting the drag data to the drag event's MimeData bundle.\n   *\n   * The default implementation adds mime data indicating the index of the direct\n   * child being dragged (as indicated by findDragTarget).\n   *\n   * Override this method if you have data that cannot be communicated well by an\n   * index, for example if the data should be able to be dropped on an external\n   * target that only understands direct mime data.\n   *\n   * As the method simply adds mime data for a specific key, overriders can call\n   * this method before/after adding their own mime data to still support default\n   * dragging behavior.\n   */\n  protected abstract addMimeData(handle: HTMLElement, mimeData: MimeData): void;\n\n  /**\n   * Processes a drop event.\n   *\n   * This function is called after checking:\n   *  - That the `dropTarget` is a valid drop target\n   *  - The value of `event.source` if `acceptDropsFromExternalSource` is false\n   *\n   * The default implementation assumes calling `getIndexOfChildNode` with\n   * `dropTarget` will be valid. It will call `move` with that index as `to`,\n   * and the index stored in the mime data as `from`.\n   *\n   * Override this if you need to handle other mime data than the default.\n   */\n  protected processDrop(dropTarget: HTMLElement, event: Drag.Event): void {\n    if (!DropWidget.isValidAction(event.supportedActions, \"move\") ||\n        event.proposedAction === \"none\") {\n      // The default implementation only handles move action\n      // OR Accept proposed none action, and perform no-op\n      event.dropAction = \"none\";\n      event.preventDefault();\n      event.stopPropagation();\n      return;\n    }\n    if (!this.validateSource(event)) {\n      // Source indicates external drop, incorrect use in subclass\n      throw new Error(\"Invalid source!\");\n    }\n\n    // We have an acceptable drop, handle:\n    const action = this.move(event.mimeData, dropTarget);\n    event.preventDefault();\n    event.stopPropagation();\n    event.dropAction = action;\n  }\n}\n\n\n/**\n * The namespace for the `DropWidget` class statics.\n */\nexport\nnamespace DropWidget {\n  /**\n   * An options object for initializing a drag widget widget.\n   */\n  export\n  interface IOptions extends Widget.IOptions {\n    /**\n     * Whether the lsit should accept drops from an external source.\n     * Defaults to false.\n     *\n     * This option only makes sense to set for subclasses that accept drops from\n     * external sources.\n     */\n    acceptDropsFromExternalSource?: boolean;\n\n    /**\n     * Which mimetypes are acceptable for drops\n     */\n    acceptedDropMimeTypes?: string[];\n  }\n\n  /**\n   * Validate a drop action against a SupportedActions type\n   */\n  export\n  function isValidAction(supported: Drag.SupportedActions, action: Drag.DropAction): boolean {\n    switch (supported) {\n      case \"all\":\n        return true;\n      case \"link-move\":\n        return action === \"move\" || action === \"link\";\n      case \"copy-move\":\n        return action === \"move\" || action === \"copy\";\n      case \"copy-link\":\n        return action === \"link\" || action === \"copy\";\n      default:\n        return action === supported;\n    }\n  }\n}\n\n/**\n * The namespace for the `DragWidget` class statics.\n */\nexport\nnamespace DragWidget {\n  /**\n   * An options object for initializing a drag widget widget.\n   */\n  export\n  interface IOptions extends Widget.IOptions {\n  }\n\n  /**\n   * Mark a widget as a drag handle.\n   *\n   * Using this, any child-widget can be a drag handle, as long as mouse events\n   * are propagated from it to the DragWidget.\n   */\n  export\n  function makeHandle(handle: Widget) {\n    handle.addClass(DRAG_HANDLE);\n  }\n\n  /**\n   * Unmark a widget as a drag handle\n   */\n  export\n  function unmakeHandle(handle: Widget) {\n    handle.removeClass(DRAG_HANDLE);\n  }\n\n  /**\n   * Create a default handle widget for dragging (see styling in DragWidget.css).\n   *\n   * The handle will need to be styled to ensure a minimum size\n   */\n  export\n  function createDefaultHandle(): Widget {\n    const widget = new Widget();\n    widget.addClass(DEFAULT_DRAG_HANDLE_CLASS);\n    makeHandle(widget);\n    return widget;\n  }\n}\n\n\n/**\n * The namespace for the `DragDropWidget` class statics.\n */\nexport\nnamespace DragDropWidget {\n  export\n  interface IOptions extends DragWidget.IOptions, DropWidget.IOptions {\n  }\n}\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport { URLExt } from \"@jupyterlab/coreutils\";\nimport { ServerConnection } from \"@jupyterlab/services\";\n\nexport interface IFSOptions {\n  _addServerside?: boolean;\n\n  /**\n   * If true, only recreate the actual resource when necessary\n   */\n  cache?: boolean;\n\n  /**\n   * If true, enable jupyter-fs debug output in both frontend and backend\n   */\n  verbose?: boolean;\n\n  /**\n   * The version of the package that these settings were written with\n   */\n  writtenVersion?: string;\n}\n\n\n/**\n * A resource configuration as stored in the settings system.\n */\nexport interface IFSSettingsResource {\n  /**\n   * The name of this resource\n   */\n  name?: string;\n\n  /**\n   * The fsurl specifying this resource\n   */\n  url?: string;\n\n  /**\n   * Auth scheme to be used for this resource, or none\n   */\n  auth: \"ask\" | \"env\" | \"none\";\n\n  /**\n   * Backend type\n   */\n  type: \"pyfs\" | \"fsspec\";\n\n  /**\n   * Fallback for determining if resource is writeable. Used only if the underlying PyFilesystem does not provide this information (eg S3)\n   */\n  defaultWritable?: boolean;\n\n  /**\n   * Directory to be first opened\n   */\n  preferredDir?: string;\n\n  /**\n   * Generic arguments to pass through to instantiation, for elements\n   * that cannot be placed in the resource url. Represented as JSON\n   */\n  kwargs?: JSON;\n}\n\n\n/**\n * An object defining an FS resource.\n */\nexport interface IFSResource extends IFSSettingsResource {\n  /**\n   * The name of this resource\n   */\n  name: string;\n\n  /**\n   * The fsurl specifying this resource\n   */\n  url: string;\n\n  /**\n   * The jupyterlab drive name associated with this resource. This is defined\n   * on resource initialization\n   */\n  drive?: string;\n\n  /**\n   * `true` if resource has been initialized\n   */\n  init?: boolean;\n\n  /**\n   * If present, a list of \"{{token}}\" template parameters that were missing\n   * from the tokenDict on the most recent attempt to initialize this resource\n   */\n  missingTokens?: string[];\n\n  /**\n   * If present, a dict of [token, value] pairs that will be substituted\n   * for any \"{{token}}\" template parameters present in the url on resource\n   * initialization\n   */\n  tokenDict?: {[key: string]: string};\n\n  /**\n   * Any errors during initialization\n   */\n  errors?: string[];\n\n}\n\nexport interface IFSComm {\n  /**\n   * Send a parameterized GET request to the `/jupyterfs/resources` api, and\n   * return the result.\n   */\n  getResourcesRequest: () => Promise<IFSResource[]>;\n\n  /**\n   * Send a parameterized POST request to the `/jupyterfs/resources` api, and\n   * return the result.\n   */\n  initResourceRequest: (args: {options: IFSOptions; resources: IFSResource[]}) => Promise<IFSResource[]>;\n\n  /**\n   * The base url to prefix onto the uri of this Comm's requests\n   */\n  baseUrl: string;\n}\n\nabstract class FSCommBase implements IFSComm {\n  protected _settings: ServerConnection.ISettings | undefined = undefined;\n\n  abstract getResourcesRequest(): Promise<IFSResource[]>;\n  abstract initResourceRequest(args: {options: IFSOptions; resources: IFSResource[]}): Promise<IFSResource[]>;\n\n  get baseUrl(): string {\n    return this.settings.baseUrl;\n  }\n\n  get resourcesUrl(): string {\n    return URLExt.join(this.baseUrl, \"jupyterfs/resources\");\n  }\n\n  get settings(): ServerConnection.ISettings {\n    if (!this._settings) {\n      this._settings = ServerConnection.makeSettings();\n    }\n\n    return this._settings;\n  }\n}\n\nexport class FSComm extends FSCommBase {\n\n  private static _instance: FSComm;\n\n  static get instance(): FSComm {\n    if (FSComm._instance === undefined) {\n      FSComm._instance = new FSComm();\n    }\n    return FSComm._instance;\n  }\n\n  async getResourcesRequest(): Promise<IFSResource[]> {\n    const settings = this.settings;\n    const fullUrl = this.resourcesUrl;\n\n    return ServerConnection.makeRequest(\n      fullUrl,\n      { method: \"GET\" },\n      settings\n    ).then(response => {\n      if (response.status !== 200) {\n        return response.text().then(data => {\n          throw new ServerConnection.ResponseError(response, data);\n        });\n      }\n\n      return response.json();\n    });\n  }\n\n  async initResourceRequest(args: {options: IFSOptions; resources: IFSResource[]}): Promise<IFSResource[]> {\n    const settings = this.settings;\n    const fullUrl = this.resourcesUrl;\n\n    return ServerConnection.makeRequest(\n      fullUrl,\n      {\n        body: JSON.stringify(args),\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        method: \"POST\",\n      },\n      settings\n    ).then(response => {\n      if (response.status !== 200) {\n        return response.text().then(data => {\n          throw new ServerConnection.ResponseError(response, data);\n        });\n      }\n      return response.json();\n    });\n  }\n}\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport { LabIcon } from \"@jupyterlab/ui-components\";\n\nimport driveSvgstr from \"../style/icons/drive.svg\";\nimport fileTreeSvgstr from \"../style/icons/file-tree.svg\";\nimport jupyterFsSvgstr from \"../style/icons/jupyter-fs.svg\";\nimport visibilitySvgstr from \"../style/icons/visibility.svg\";\nimport visibilityOffSvgstr from \"../style/icons/visibility-off.svg\";\n\nexport const driveIcon = new LabIcon({ name: \"jfs:drive\", svgstr: driveSvgstr });\nexport const fileTreeIcon = new LabIcon({ name: \"jfs:file-tree\", svgstr: fileTreeSvgstr });\nexport const jupyterFsIcon = new LabIcon({ name: \"jfs:jupyter-fs\", svgstr: jupyterFsSvgstr });\nexport const visibilityIcon = new LabIcon({ name: \"jfs:visibility\", svgstr: visibilitySvgstr });\nexport const visibilityOffIcon = new LabIcon({ name: \"jfs:visibility-off\", svgstr: visibilityOffSvgstr });\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\n\nimport { ILayoutRestorer, IRouter, JupyterFrontEnd, JupyterFrontEndPlugin } from \"@jupyterlab/application\";\nimport { IThemeManager, IWindowResolver } from \"@jupyterlab/apputils\";\nimport { IDocumentManager } from \"@jupyterlab/docmanager\";\nimport { ISettingRegistry } from \"@jupyterlab/settingregistry\";\nimport { IStatusBar } from \"@jupyterlab/statusbar\";\nimport { ITranslator } from \"@jupyterlab/translation\";\nimport { folderIcon, fileIcon, notebookIcon, IFormRendererRegistry } from \"@jupyterlab/ui-components\";\nimport { IDisposable } from \"@lumino/disposable\";\nimport * as semver from \"semver\";\n\nimport { commandIDs, createDynamicCommands, createStaticCommands, idFromResource } from \"./commands\";\nimport { ContentsProxy } from \"./contents_proxy\";\nimport { IFSOptions, IFSResource, IFSSettingsResource } from \"./filesystem\";\nimport { FileUploadStatus } from \"./progress\";\nimport { migrateSettings, unpartialResource } from \"./settings\";\nimport { snippetFormRender } from \"./snippets\";\nimport { TreeFinderSidebar } from \"./treefinder\";\nimport { ITreeFinderMain } from \"./tokens\";\nimport { initResources } from \"./resources\";\n\n// tslint:disable: variable-name\n\nconst BROWSER_ID = \"jupyter-fs:plugin\";\nexport const browser: JupyterFrontEndPlugin<ITreeFinderMain> = {\n  autoStart: true,\n  id: BROWSER_ID,\n  requires: [\n    IDocumentManager,\n    JupyterFrontEnd.IPaths,\n    IWindowResolver,\n    ILayoutRestorer,\n    IRouter,\n    ISettingRegistry,\n    IThemeManager,\n  ],\n  optional: [IFormRendererRegistry],\n  provides: ITreeFinderMain,\n\n  async activate(\n    app: JupyterFrontEnd,\n    manager: IDocumentManager,\n    paths: JupyterFrontEnd.IPaths,\n    resolver: IWindowResolver,\n    restorer: ILayoutRestorer,\n    router: IRouter,\n    settingRegistry: ISettingRegistry,\n    themeManager: IThemeManager,\n    editorRegistry: IFormRendererRegistry | null\n  ): Promise<ITreeFinderMain> {\n    const widgetMap : {[key: string]: TreeFinderSidebar} = {};\n    let commands: IDisposable | undefined;\n\n    // Attempt to load application settings\n    let settings: ISettingRegistry.ISettings | undefined;\n    try {\n      settings = await settingRegistry.load(BROWSER_ID);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.warn(`Failed to load settings for the jupyter-fs extension.\\n${error}`);\n      return { tracker: TreeFinderSidebar.tracker };\n    }\n\n    // Migrate any old settings\n    const initialOptions = settings?.composite.options as unknown as IFSOptions | undefined;\n    if ((settings && semver.lt(initialOptions?.writtenVersion || \"0.0.0\", settings.version))) {\n      settings = await migrateSettings(settings);\n    }\n\n    if (editorRegistry) {\n      editorRegistry.addRenderer(`${BROWSER_ID}.snippets`, { fieldRenderer: snippetFormRender });\n    }\n\n    let columns = settings?.composite.display_columns as Array<keyof ContentsProxy.IJupyterContentRow> ?? [\"size\"];\n\n    const sharedSidebarProps: Omit<TreeFinderSidebar.ISidebarProps, \"type\" | \"url\"> = {\n      app,\n      manager,\n      paths,\n      resolver,\n      restorer,\n      router,\n      columns,\n      settings,\n    };\n\n    createStaticCommands(app, TreeFinderSidebar.tracker, TreeFinderSidebar.clipboard);\n\n    async function refreshWidgets({ resources, options }: {resources: IFSResource[]; options: IFSOptions}) {\n      if (options.verbose) {\n        // eslint-disable-next-line no-console\n        console.info(`jupyter-fs frontend received resources:\\n${JSON.stringify(resources)}`);\n      }\n\n      columns = settings?.composite.display_columns as Array<keyof ContentsProxy.IJupyterContentRow> ?? [\"size\"];\n      sharedSidebarProps.columns = columns;\n\n      // create the fs resource frontends (ie FileTree instances)\n      for (const r of resources) {\n        // make one composite disposable for all fs resource frontends\n        const id = idFromResource(r);\n        let w = widgetMap[id];\n        if (!w || w.isDisposed) {\n          const sidebarProps = { ...sharedSidebarProps, url: r.url, type: r.type, settings: settings! };\n          w = TreeFinderSidebar.sidebarFromResource(r, sidebarProps);\n          widgetMap[id] = w;\n        } else {\n          w.treefinder.columns = columns;\n        }\n      }\n      commands = await createDynamicCommands(\n        app,\n        TreeFinderSidebar.tracker,\n        TreeFinderSidebar.clipboard,\n        resources,\n        settings\n      );\n    }\n\n    async function refresh() {\n      // get user settings from json file\n      let resources: IFSResource[] = (\n        settings?.composite.resources as unknown as IFSSettingsResource[] ?? []\n      ).map(unpartialResource);\n      const options: IFSOptions = settings?.composite.options as any ?? {};\n\n      function cleanup(all=false) {\n        if (commands) {\n          commands.dispose();\n          commands = undefined;\n        }\n        const keys = resources.map(idFromResource);\n        for (const key of Object.keys(widgetMap)) {\n          if (all || keys.indexOf(key) === -1) {\n            widgetMap[key].dispose();\n            delete widgetMap[key];\n          }\n        }\n      }\n\n      try {\n        resources = (await initResources(resources, options)).filter(r => r.init);\n        cleanup();\n        await refreshWidgets({ resources, options });\n      } catch (e) {\n        console.error(\"Failed to refresh widgets!\", e);\n        cleanup(true);\n      }\n    }\n\n    // when ready, restore using command\n    const refreshed = refresh();\n    void restorer.restore(TreeFinderSidebar.tracker, {\n      command: commandIDs.restore,\n      args: widget => ({\n        id: widget.id,\n        rootPath: widget.treefinder.model?.root.pathstr,\n      }),\n      name: widget => widget.id,\n      when: refreshed,\n    });\n\n    if (settings) {\n      // rerun setup whenever relevant settings change\n      settings.changed.connect(() => {\n        void refresh();\n      });\n    }\n\n    // Inject lab icons\n    const style = document.createElement(\"style\");\n    style.setAttribute(\"id\", \"jupyter-fs-icon-inject\");\n\n    // Hackish, but needed since free-finder insists on pseudo elements for icons.\n    function iconStyleContent(folderStr: string, fileStr: string, notebookStr: string) {\n      // Note: We aren't able to style the hover/select colors with this.\n      return `\n      .jp-tree-finder {\n        --tf-dir-icon: url('data:image/svg+xml,${encodeURIComponent(folderStr)}');\n        --tf-file-icon: url('data:image/svg+xml,${encodeURIComponent(fileStr)}');\n        --tf-notebook-icon: url('data:image/svg+xml,${encodeURIComponent(notebookStr)}');\n      }\n      `;\n    }\n\n    let initialThemeLoad = true;\n    themeManager.themeChanged.connect(() => {\n      // Update SVG icon fills (since we put them in pseudo-elements we cannot style with CSS)\n      const primary = getComputedStyle(document.documentElement).getPropertyValue(\"--jp-ui-font-color1\");\n      style.textContent = iconStyleContent(\n        folderIcon.svgstr.replace(/fill=\"([^\"]{0,7})\"/, `fill=\"${primary}\"`),\n        fileIcon.svgstr.replace(/fill=\"([^\"]{0,7})\"/, `fill=\"${primary}\"`),\n        notebookIcon.svgstr.replace(/fill=\"([^\"]{0,7})\"/, `fill=\"${primary}\"`)\n      );\n\n      // Refresh widgets in case font/border sizes etc have changed\n      if (initialThemeLoad) {\n        initialThemeLoad = false;\n        // Don't refresh on first load since we will do it below after initial creation\n        // in the onAfterAttach lifecycle method.\n      } else {\n        Object.keys(widgetMap).map(\n          key => widgetMap[key].treefinder.load()\n        );\n      }\n    });\n\n    style.textContent = iconStyleContent(folderIcon.svgstr, fileIcon.svgstr, notebookIcon.svgstr);\n\n    document.head.appendChild(style);\n\n    // eslint-disable-next-line no-console\n    console.log(\"JupyterLab extension jupyter-fs is activated!\");\n    return { tracker: TreeFinderSidebar.tracker };\n  },\n};\n\n\nconst PROGRESS_ID = \"jupyter-fs:progress\";\nexport const progressStatus: JupyterFrontEndPlugin<void> = {\n  autoStart: true,\n  id: PROGRESS_ID,\n  requires: [\n    ITranslator,\n  ],\n  optional: [\n    ITreeFinderMain,\n    IStatusBar,\n  ],\n  activate(\n    app: JupyterFrontEnd,\n    translator: ITranslator,\n    main: ITreeFinderMain | null,\n    statusbar: IStatusBar | null,\n  ) {\n    if (!statusbar || !main) {\n      return;\n    }\n    const item = new FileUploadStatus({\n      tracker: main.tracker,\n      translator,\n    });\n    statusbar.registerStatusItem(\n      PROGRESS_ID,\n      {\n        item,\n        align: \"middle\",\n        isActive: () => !!(item.model?.items.length),\n        activeStateChanged: item.model.stateChanged,\n      }\n    );\n  },\n};\n\nexport default [\n  browser,\n  progressStatus,\n];\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\n\n/* Based on code from JupyterLab, copied under the following license:\n\nCopyright (c) 2015-2021 Project Jupyter Contributors\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this\n   list of conditions and the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice,\n   this list of conditions and the following disclaimer in the documentation\n   and/or other materials provided with the distribution.\n\n3. Neither the name of the copyright holder nor the names of its\n   contributors may be used to endorse or promote products derived from\n   this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\nAND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\nIMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\nFOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\nSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\nCAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\nOR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport { VDomModel, VDomRenderer, WidgetTracker } from \"@jupyterlab/apputils\";\nimport { IChangedArgs } from \"@jupyterlab/coreutils\";\nimport { GroupItem, ProgressBar, TextItem } from \"@jupyterlab/statusbar\";\nimport {\n  ITranslator,\n  nullTranslator,\n} from \"@jupyterlab/translation\";\nimport { ArrayExt } from \"@lumino/algorithm\";\nimport React from \"react\";\n\nimport type { TreeFinderSidebar } from \"./treefinder\";\nimport type { IUploadProgress, Uploader } from \"./upload\";\n\n/**\n * Half-spacing between items in the overall status item.\n */\nconst HALF_SPACING = 4;\n\n/**\n * A pure function component for a FileUpload status item.\n *\n * @param props: the props for the component.\n *\n * @returns a tsx component for the file upload status.\n */\nfunction FileUploadComponent(\n  props: FileUploadComponent.IProps\n): React.ReactElement<FileUploadComponent.IProps> {\n  const translator = props.translator || nullTranslator;\n  const trans = translator.load(\"jupyterlab\");\n  const items = [<TextItem source={trans.__(\"Uploading\")} />];\n  items.push(...props.items.map(\n    i => i.complete ?\n      <TextItem source={trans.__(\"Complete!\")} /> :\n      <ProgressBar percentage={i.progress}/>\n  ));\n  return (\n    <GroupItem spacing={HALF_SPACING}>\n      {...items}\n    </GroupItem>\n  );\n}\n\n/**\n * A namespace for FileUploadComponent statics.\n */\nnamespace FileUploadComponent {\n  /**\n   * The props for the FileUploadComponent.\n   */\n  export interface IProps {\n    /**\n     * The current upload percentage, from 0 to 100.\n     */\n    items: IFileUploadItem[];\n\n    /**\n     * The language translator.\n     */\n    translator?: ITranslator;\n  }\n}\n\n/**\n * The time for which to show the \"Complete!\" message after uploading.\n */\nconst UPLOAD_COMPLETE_MESSAGE_MILLIS = 2000;\n\n/**\n * Status bar item to display file upload progress.\n */\nexport class FileUploadStatus extends VDomRenderer<FileUploadStatus.Model> {\n  /**\n   * Construct a new FileUpload status item.\n   */\n  constructor(opts: FileUploadStatus.IOptions) {\n    super(\n      new FileUploadStatus.Model(opts.tracker.currentWidget)\n    );\n    this.translator = opts.translator || nullTranslator;\n    this._tracker = opts.tracker;\n    this._tracker.currentChanged.connect(this._onTreeFinderChange);\n  }\n\n  /**\n   * Render the FileUpload status.\n   */\n  render() {\n    const items = this.model.items;\n    if (items.length > 0) {\n      return (\n        <FileUploadComponent\n          items={this.model.items}\n          translator={this.translator}\n        />\n      );\n    } else {\n      return <></>;\n    }\n  }\n\n  dispose() {\n    super.dispose();\n    this._tracker.currentChanged.disconnect(this._onTreeFinderChange);\n  }\n\n  private _onTreeFinderChange = (\n    tracker: WidgetTracker<TreeFinderSidebar>,\n    sidebar: TreeFinderSidebar | null\n  ) => {\n    if (sidebar === null) {\n      this.model.sidebar = null;\n    } else {\n      this.model.sidebar = sidebar;\n    }\n  };\n\n  private readonly translator: ITranslator;\n  private _tracker: WidgetTracker<TreeFinderSidebar>;\n}\n\n/**\n * A namespace for FileUpload class statics.\n */\nexport namespace FileUploadStatus {\n  /**\n   * The VDomModel for the FileUpload renderer.\n   */\n  export class Model extends VDomModel {\n    /**\n     * Construct a new model.\n     */\n    constructor(sidebar: TreeFinderSidebar | null) {\n      super();\n      this.sidebar = sidebar;\n    }\n\n    /**\n     * The currently uploading items.\n     */\n    get items() {\n      return this._items;\n    }\n\n    /**\n     * The current file browser model.\n     */\n    get sidebar(): TreeFinderSidebar | null {\n      return this._sidebar;\n    }\n    set sidebar(browserModel: TreeFinderSidebar | null) {\n      const oldSidebar = this._sidebar;\n      if (oldSidebar) {\n        oldSidebar.treefinder.uploader!.uploadChanged.disconnect(this._uploadChanged);\n      }\n\n      this._sidebar = browserModel;\n      this._items = [];\n\n      if (this._sidebar !== null) {\n        this._sidebar.treefinder.uploader!.uploadChanged.connect(this._uploadChanged);\n      }\n\n      this.stateChanged.emit(void 0);\n    }\n\n    /**\n     * Handle an uploadChanged event in the filebrowser model.\n     */\n    private _uploadChanged = (\n      uploader: Uploader,\n      uploads: IChangedArgs<IUploadProgress>\n    ) => {\n      if (uploads.name === \"start\") {\n        this._items.push({\n          path: uploads.newValue.path,\n          progress: uploads.newValue.progress * 100,\n          complete: false,\n        });\n      } else if (uploads.name === \"update\") {\n        const idx = ArrayExt.findFirstIndex(\n          this._items,\n          val => val.path === uploads.oldValue.path\n        );\n        if (idx !== -1) {\n          this._items[idx].progress = uploads.newValue.progress * 100;\n        }\n      } else if (uploads.name === \"finish\") {\n        const finishedItem = ArrayExt.findFirstValue(\n          this._items,\n          val => val.path === uploads.oldValue.path\n        );\n\n        if (finishedItem) {\n          finishedItem.complete = true;\n          setTimeout(() => {\n            ArrayExt.removeFirstOf(this._items, finishedItem);\n            this.stateChanged.emit(void 0);\n          }, UPLOAD_COMPLETE_MESSAGE_MILLIS);\n        }\n      } else if (uploads.name === \"failure\") {\n        ArrayExt.removeFirstWhere(\n          this._items,\n          val => val.path === uploads.newValue.path\n        );\n      }\n\n      this.stateChanged.emit(void 0);\n    };\n\n    private _items: IFileUploadItem[] = [];\n    private _sidebar: TreeFinderSidebar | null = null;\n  }\n\n  /**\n   * Options for creating the upload status item.\n   */\n  export interface IOptions {\n    /**\n     * The application file browser tracker.\n     */\n    readonly tracker: WidgetTracker<TreeFinderSidebar>;\n\n    /**\n     * The translation language bundle.\n     */\n    readonly translator?: ITranslator;\n  }\n}\n\n/**\n * The interface for an item that is being uploaded to\n * the file system.\n */\ninterface IFileUploadItem {\n  /**\n   * The path on the filesystem that is being uploaded to.\n   */\n  path: string;\n\n  /**\n   * The upload progress fraction.\n   */\n  progress: number;\n\n  /**\n   * Whether the upload is complete.\n   */\n  complete: boolean;\n}\n","import { PromiseDelegate } from \"@lumino/coreutils\";\n\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\n\nimport { askRequired, AskDialog } from \"./auth\";\nimport { FSComm, IFSResource, IFSOptions } from \"./filesystem\";\n\n\n/**\n * Init resource on the server, and prompt for credentials via a dialog if needed.\n *\n * @param resources The resources to initialize to.\n * @param options The initialization options to use.\n * @returns All resources, whether inited or not\n */\nexport async function initResources(resources: IFSResource[], options: IFSOptions): Promise<IFSResource[]> {\n  const delegate = new PromiseDelegate<IFSResource[]>();\n  // send user specs to backend; await return containing resources\n  // defined by user settings + resources defined by server config\n  resources = await FSComm.instance.initResourceRequest({\n    resources,\n    options: {\n      ...options,\n      _addServerside: true,\n    },\n  });\n\n  if (askRequired(resources)) {\n    // ask for url template values, if required\n    const dialogElem = document.createElement(\"div\");\n    document.body.appendChild(dialogElem);\n\n    let submitted = false;\n    const handleClose = () => {\n      try {\n        ReactDOM.unmountComponentAtNode(dialogElem);\n        dialogElem.remove();\n        if (!submitted) {\n          delegate.resolve(resources);\n        }\n      } catch (e) {\n        delegate.reject(e);\n      }\n    };\n\n    const handleSubmit = async (values: {[url: string]: {[key: string]: string}}) => {\n      try {\n        submitted = true;\n        resources = await FSComm.instance.initResourceRequest({\n          resources: resources.map(r => ({ ...r, tokenDict: values[r.url] })),\n          options,\n        });\n        delegate.resolve(resources);\n      } catch (e) {\n        delegate.reject(e);\n      }\n    };\n\n    ReactDOM.render(\n      <AskDialog\n        handleClose={handleClose}\n        handleSubmit={handleSubmit}\n        options={options}\n        resources={resources}\n      />,\n      dialogElem,\n    );\n\n  } else {\n    delegate.resolve(resources);\n  }\n  return delegate.promise;\n}\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport { ISettingRegistry } from \"@jupyterlab/settingregistry\";\nimport * as semver from \"semver\";\n\nimport type { IFSOptions, IFSResource, IFSSettingsResource } from \"./filesystem\";\nimport type { RawSnippet } from \"./snippets\";\n\n/**\n * Migrate any settings from an older version of the package\n *\n * @param settings Our settings to consider for migratation\n * @returns The modified settings object\n */\nexport async function migrateSettings(settings: ISettingRegistry.ISettings): Promise<ISettingRegistry.ISettings> {\n  const options = settings?.composite.options as unknown as IFSOptions | undefined;\n  if (semver.lt(options?.writtenVersion || \"0.0.0\", \"0.4.0-alpha.8\")) {\n    // Migrate snippets to include defaults that were updated after version checked\n    const defaultSnippets = (settings?.default(\"snippets\") ?? []) as unknown as RawSnippet[];\n    const defaultLabels = defaultSnippets.map( snippet => snippet.label );\n    const userSnippets = (settings?.user.snippets ?? []) as unknown as RawSnippet[];\n\n    // add the user defined snippets if they have different label to defaults\n    const raw = userSnippets.reduce((combinedSnippetsArray, snippet) => {\n      if (!defaultLabels.includes(snippet.label)) {\n        combinedSnippetsArray.push(snippet);\n      }\n      return combinedSnippetsArray;\n    }, [...defaultSnippets]) ?? [];\n\n    await settings.set(\"snippets\", raw as Array<Partial<RawSnippet>>);\n  }\n\n  // Update version\n  await settings.set(\"options\", {\n    ...options,\n    writtenVersion: settings.version,\n  });\n  return settings;\n}\n\n\n/**\n * Ensure undefined string values from settings that are required are translated to empty strings\n * @param settingsResoruce\n * @returns A filled in setting object\n */\nexport function unpartialResource(settingsResource: IFSSettingsResource): IFSResource {\n  return { name: \"\", url: \"\", ...settingsResource };\n}\n","/******************************************************************************\n *\n * Copyright (c) 2023, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport { URLExt } from \"@jupyterlab/coreutils\";\nimport { ServerConnection } from \"@jupyterlab/services\";\nimport { ISettingRegistry } from \"@jupyterlab/settingregistry\";\nimport * as React from \"react\";\n\nimport type { FieldProps } from \"@rjsf/utils\";\nimport { splitPathstrDrive } from \"./contents_utils\";\n\nfunction _mknode(obj: any, paths: string[]) {\n  for (const path of paths) {\n    obj = obj[path] = obj[path] ?? {};\n  }\n  return obj;\n}\n\n/**\n * Trick to set uiSchema on our settings editor form elements.\n *\n * We use it to set the \"template\" to a \"textarea\" multiline input\n */\nexport function snippetFormRender(props: FieldProps) {\n  const ArrayField = props.registry.fields.ArrayField;\n  const uiSchema = { ...props.uiSchema };\n  const templateUiSchema = _mknode(uiSchema, [\"items\", \"template\"]);\n  templateUiSchema[\"ui:widget\"] = \"textarea\";\n  return <ArrayField {...props} uiSchema={uiSchema} />;\n}\n\n\nexport interface RawSnippet {\n  label: string;\n  caption: string;\n  pattern: string;\n  template: string;\n}\n\ninterface ISnippetsResponse {\n  snippets: RawSnippet[];\n}\n\nconst processUrlRegex = /^(?<protocol>.+?):\\/\\/(?:[^@]+@)?(?<resource>.*)$/;\nconst templateTokenFinders = {} as {[key: string]: RegExp};\n\n\n/**\n * A usage snippet specification\n */\nexport interface Snippet {\n  /**\n   * The designator to show to users\n   */\n  label: string;\n\n  /**\n   * An optional, longer description to show to users\n   */\n  caption: string;\n\n  /**\n   * A regular expression to match against the full URL of the entry, indicating if this snippet is valid for it\n   */\n  pattern: RegExp;\n\n  /**\n   * A template string to build up the snippet\n   */\n  template: string;\n\n  /**\n   * A template string to build up the snippet\n   */\n  type?: string;\n}\n\n\n/**\n * Get all the snippet specifications in the settings\n */\nexport function getSettingsSnippets(settings?: ISettingRegistry.ISettings): Snippet[] {\n  const raw = (settings?.composite.snippets ?? []) as any as RawSnippet[];\n  return raw.map(s => ({ ...s, pattern: new RegExp(s.pattern) }));\n}\n\n/**\n * Gets all the snippet specifications configured on the server\n */\nexport async function getServerSnippets(settings?: ServerConnection.ISettings): Promise<Snippet[]> {\n  if (!settings) {\n    settings = ServerConnection.makeSettings();\n  }\n  return ServerConnection.makeRequest(\n    URLExt.join(settings.baseUrl, \"/jupyterfs/snippets\"),\n    { method: \"GET\" },\n    settings\n  ).then(response => {\n    if (!response.ok) {\n      return Promise.reject(response);\n    }\n    return response.json() as Promise<ISnippetsResponse>;\n  }).then(data => data.snippets.map(s => ({ ...s, pattern: new RegExp(s.pattern) })));\n}\n\n/**\n * Get the snippet specifications from all sources\n */\nexport async function getAllSnippets(settings?: ISettingRegistry.ISettings): Promise<Snippet[]> {\n  return (await getServerSnippets()).concat(getSettingsSnippets(settings));\n}\n\n\n/**\n * Instantiate the template of a snippet.\n *\n * @param template The template to instantiate\n * @param resource The resource the entry belongs to\n * @param path The local path of the entry\n */\nexport function instantiateSnippet(template: string, url: string, type: string, pathstr: string) {\n  const parsed = processUrlRegex.exec(url);\n  const [drive, relativePath] = splitPathstrDrive(pathstr);\n  const args = {\n    ...parsed?.groups,\n    url,\n    type,\n    path: relativePath,\n    full_url: `${url.replace(/\\/$/, \"\")}/${relativePath}`,\n    full_path: `${drive}:/${relativePath}`,\n    drive,\n  };\n\n  let templated = template;\n  for (const key of Object.keys(args) as Array<keyof typeof args>) {\n    if (!(key in templateTokenFinders)) {\n      // match `key` wrapped in double curly-braces (and optionally whitespace padding within the braces)\n      templateTokenFinders[key] = new RegExp(`\\\\{\\\\{\\\\s*${key}\\\\s*\\\\}\\\\}`, \"g\");\n    }\n    templated = templated.replace(templateTokenFinders[key], args[key]);\n  }\n  return templated;\n}\n","\nimport { WidgetTracker } from \"@jupyterlab/apputils\";\nimport { Token } from \"@lumino/coreutils\";\nimport { TreeFinderSidebar } from \"./treefinder\";\n\nexport const ITreeFinderMain = new Token<ITreeFinderMain>(\n  \"@jupyterlab/filebrowser:IFileBrowserFactory\"\n);\n\n/**\n * The file browser factory interface.\n */\nexport interface ITreeFinderMain {\n  /**\n   * The widget tracker that tracks tree finders.\n   */\n  readonly tracker: WidgetTracker<TreeFinderSidebar>;\n}\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n*\n* This file is part of the jupyter-fs library, distributed under the terms of\n* the Apache License 2.0.  The full license can be found in the LICENSE file.\n*\n*/\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { ILayoutRestorer, IRouter, JupyterFrontEnd } from \"@jupyterlab/application\";\nimport {\n  Dialog,\n  IWindowResolver,\n  showDialog,\n  showErrorMessage,\n  Toolbar,\n  ToolbarButton,\n  WidgetTracker, /*Clipboard, Dialog, IWindowResolver, showDialog*/\n} from \"@jupyterlab/apputils\";\n\n// import { PathExt, URLExt } from \"@jupyterlab/coreutils\";\nimport { IDocumentManager, isValidFileName /*renameFile*/ } from \"@jupyterlab/docmanager\";\n// import { DocumentRegistry } from \"@jupyterlab/docregistry\";\nimport { ISettingRegistry } from \"@jupyterlab/settingregistry\";\nimport {\n  ITranslator,\n  nullTranslator,\n  TranslationBundle,\n} from \"@jupyterlab/translation\";\nimport {\n  refreshIcon,\n  newFolderIcon,\n  addIcon,\n} from \"@jupyterlab/ui-components\";\n// import JSZip from \"jszip\";\nimport { ArrayExt } from \"@lumino/algorithm\";\nimport { CommandRegistry } from \"@lumino/commands\";\nimport { PromiseDelegate } from \"@lumino/coreutils\";\nimport { Message } from \"@lumino/messaging\";\nimport { PanelLayout, Widget } from \"@lumino/widgets\";\nimport { Content, ContentsModel, Format, Path, TreeFinderGridElement, TreeFinderPanelElement } from \"@tree-finder/base\";\n\nimport { JupyterClipboard } from \"./clipboard\";\nimport { commandIDs, idFromResource } from \"./commands\";\nimport { ContentsProxy } from \"./contents_proxy\";\nimport { getContentParent, revealPath, openDirRecursive } from \"./contents_utils\";\nimport { DragDropWidget, TABLE_HEADER_MIME } from \"./drag\";\nimport { IFSResource } from \"./filesystem\";\nimport { fileTreeIcon } from \"./icons\";\nimport { promptRename } from \"./utils\";\nimport { Uploader, UploadButton } from \"./upload\";\nimport { MimeData } from \"@lumino/coreutils\";\nimport { Drag } from \"@lumino/dragdrop\";\n\n\nexport class TreeFinderTracker extends WidgetTracker<TreeFinderSidebar> {\n  async add(finder: TreeFinderSidebar) {\n    this._finders.set(finder.id, finder);\n\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    finder.disposed.connect(this._onWidgetDisposed, this);\n\n    return super.add(finder);\n  }\n\n  remove(finder: TreeFinderSidebar) {\n    this._finders.delete(finder.id);\n\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    finder.disposed.disconnect(this._onWidgetDisposed, this);\n  }\n\n  findByDrive(drive: string) {\n    return this._finders.get(drive);\n  }\n\n  hasByDrive(drive: string) {\n    return this._finders.has(drive);\n  }\n\n  private _onWidgetDisposed(finder: TreeFinderSidebar) {\n    this.remove(finder);\n  }\n\n  private _finders = new Map<string, TreeFinderSidebar>();\n}\n\nexport class TreeFinderWidget extends DragDropWidget {\n  constructor({\n    app,\n    columns,\n    rootPath = \"\",\n    translator,\n    settings,\n  }: TreeFinderWidget.IOptions) {\n    const { commands, serviceManager: { contents } } = app;\n\n    const node = document.createElement<ContentsProxy.IJupyterContentRow>(\"tree-finder-panel\");\n    const acceptedDropMimeTypes = [TABLE_HEADER_MIME];\n    super({ node, acceptedDropMimeTypes });\n    this.addClass(\"jp-tree-finder\");\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n    this.contentsProxy = new ContentsProxy(contents, rootPath, this.onGetChildren.bind(this));\n    this.settings = settings;\n\n    this.translator = translator || nullTranslator;\n    this._trans = this.translator.load(\"jupyterlab\");\n\n    this._commands = commands;\n    this._expanding =  new Map<string, number>();\n    this._columns = columns;\n    this.rootPath = rootPath === \"\" ? rootPath : rootPath + \":\";\n    this._initialLoad = true;\n\n    this._readyDelegate = new PromiseDelegate<void>();\n    void this._readyDelegate.promise.catch(reason => showErrorMessage(\"Failed to init browser\", reason as string));\n    void this._readyDelegate.promise.then(() => {\n      // TODO: Model state of TreeFinderWidget should be updated by renamerSub process.\n      //       Currently we hard-code the refresh here, but should be moved upstream!\n      const contentsModel = this.model!;\n      contentsModel.renamerSub.subscribe(({ name, target }) => {\n        void contentsModel.sort();\n      });\n    });\n  }\n  protected move(mimeData: MimeData, target: HTMLElement): Drag.DropAction {\n    const source = mimeData.getData(TABLE_HEADER_MIME) as (keyof ContentsProxy.IJupyterContentRow);\n    const dest = target.innerText as (keyof ContentsProxy.IJupyterContentRow);\n    void this._reorderColumns(source, dest);\n    void this.nodeInit();\n    return \"move\";\n  }\n\n  protected addMimeData(handle: HTMLElement, mimeData: MimeData): void {\n    const columnName = handle.innerText;\n    mimeData.setData(TABLE_HEADER_MIME, columnName);\n  }\n\n  protected getDragImage(handle: HTMLElement): HTMLElement | null {\n    const target = this.findDragTarget(handle);\n    let img = null;\n    if (target) {\n      img = target.cloneNode(true) as HTMLElement;\n      img.classList.add(\"jp-thead-drag-image\");\n    }\n    return img;\n  }\n\n  protected onGetChildren(path: string, done: Promise<void>) {\n    if (this._initialLoad) {\n      const rootPathstr = Path.toarray(this.rootPath).join(\"/\");\n      if (path === rootPathstr) {\n        done.finally(() => {\n          this._initialLoad = false;\n          this.draw();\n        });\n      }\n    }\n    this._expanding.set(path, (this._expanding.get(path) || 0) + 1);\n    // only redraw if bumped up from 0\n    if (this._expanding.get(path) === 1) {\n      this.draw();\n    }\n    done.finally(() => {\n      this._expanding.set(path, (this._expanding.get(path) || 1) - 1);\n      // only redraw if bumped down to 0\n      if (this._expanding.get(path) === 0) {\n        this.draw();\n      }\n    });\n  }\n\n  /**\n   * Reorders the columns according to given inputs and saves to user settings\n   * If `source` is dragged from left to right, it will be inserted to the right side of `dest`\n   * Else if `source` is dragged from right to left, it will be inserted to the left side of `dest`\n   */\n  private async _reorderColumns(source: (keyof ContentsProxy.IJupyterContentRow), dest: (keyof ContentsProxy.IJupyterContentRow)) {\n    const sIndex = this._columns.indexOf(source);\n    const dIndex = this._columns.indexOf(dest);\n\n    if (sIndex < dIndex) {\n      this._columns.splice(dIndex + 1, 0, source);\n      this._columns.splice(sIndex, 1);\n    } else if (sIndex > dIndex) {\n      this._columns.splice(sIndex, 1);\n      this._columns.splice(dIndex, 0, source);\n    }\n\n    await this.settings?.set(\"display_columns\", this._columns);\n  }\n\n  draw(props: { reset?: boolean } = {}) {\n    this.model?.requestDraw();\n  }\n\n  refresh() {\n    this.model?.refreshSub.next([]);\n  }\n\n  async nodeInit() {\n    // The contents of root passed to node.init is not (currently) considered, so do not ask for it.\n    let root = null;\n\n    try {\n      root = await this.contentsProxy.get(this.rootPath, { content: false });\n    } catch (error) {\n      return;\n    }\n    this._currentFolder = this.model?.root.pathstr;\n\n    await customElements.whenDefined(\"tree-finder-panel\");\n    this.node.init({\n      root,\n      gridOptions: {\n        columnFormatters: {\n          last_modified: (x => Format.timeSince(x as any as Date)),\n          size: (x => x && Format.bytesToHumanReadable(x)),\n          writable: (x => x ? \"\" : \"\"),\n        },\n        doWindowResize: true,\n        showFilter: true,\n      },\n      modelOptions: {\n        columnNames: this.columns,\n      },\n    });\n\n    const grid = this.node.querySelector<TreeFinderGridElement<ContentsProxy.IJupyterContentRow>>(\"tree-finder-grid\");\n\n    grid?.addStyleListener(() => {\n      // Set root-level load indicator\n      grid.classList.toggle(\"jfs-mod-loading\", this._initialLoad);\n\n      // Fix corner cleanup (workaround for underlying bug where we end up with two resize handles)\n      const resizeSpans = grid.querySelectorAll(`thead tr > th:first-child > span.rt-column-resize`);\n      const nHeaderRows = grid.querySelectorAll(\"thead tr\").length;\n      if (resizeSpans.length > nHeaderRows) {\n        // something went wrong, and we ended up with double resize handles. Clear the classes from the first one:\n        for (const span of grid.querySelectorAll(`thead tr > th:first-child > span.rt-column-resize:first-child`)) {\n          span.removeAttribute(\"class\");\n        }\n      }\n\n      // Fix focus and tabbing\n      let lastSelectIdx = this.model?.selectedLast ? this.model?.contents.indexOf(this.model.selectedLast) : -1;\n      const lostFocus = document.activeElement !== this.node;\n      for (const rowHeader of grid.querySelectorAll<HTMLTableCellElement>(\"tr > th\")) {\n        const tableHeader = rowHeader.querySelector<HTMLSpanElement>(\"span.tf-header-name\");\n\n        if (tableHeader) {\n          // If tableheader is path, do not make it draggable\n          if (tableHeader.innerText !== \"path\") {\n            tableHeader.classList.add(this.dragHandleClass);\n          }\n        }\n\n        const nameElement = rowHeader.querySelector<HTMLSpanElement>(\"span.rt-group-name\");\n        // Ensure we can tab to all items\n        nameElement?.setAttribute(\"tabindex\", \"0\");\n        // Ensure last selected element retains focus after redraw:\n        if (lostFocus && nameElement && lastSelectIdx !== -1) {\n          const meta = grid.getMeta(rowHeader);\n          if (meta && meta.y === lastSelectIdx) {\n            nameElement.focus();\n            lastSelectIdx = -1;\n          }\n        }\n\n        // Add \"loading\" indicator for folders that are fetching children\n        if (nameElement) {\n          const meta = grid.getMeta(rowHeader);\n          const content = meta?.y ? this.model?.contents[meta.y] : undefined;\n          if (content) {\n            rowHeader.classList.toggle(\"jfs-mod-loading\", !!nameElement && (this._expanding.get(content.pathstr) || 0) > 0);\n          }\n        }\n      }\n    });\n    if (this.uploader) {\n      this.uploader.model = this.model!;\n    } else {\n      this.uploader = new Uploader({\n        contentsProxy: this.contentsProxy,\n        model: this.model!,\n      });\n    }\n    if (this._currentFolder) {\n      await openDirRecursive(this.model!, this._currentFolder.split(\"/\"));\n    }\n    this.model!.openSub.subscribe(rows => rows.forEach(row => {\n      if (!row.getChildren) {\n        void this._commands.execute(\"docmanager:open\", { path: Path.fromarray(row.path) });\n      } else {\n        const widget = TreeFinderSidebar.tracker.findByDrive(this.parent!.id)!;\n        void TreeFinderSidebar.tracker.save(widget);\n      }\n    }));\n  }\n\n  get columns(): Array<keyof ContentsProxy.IJupyterContentRow> {\n    return this._columns;\n  }\n  set columns(value: Array<keyof ContentsProxy.IJupyterContentRow>) {\n    if (ArrayExt.shallowEqual(this._columns, value)) {\n      return;\n    }\n    this._columns = value;\n    const m = this.model!;\n    m.options = {\n      ...m.options,\n      columnNames: this._columns,\n    };\n    m.initColumns();\n    void this.nodeInit();\n  }\n\n  get ready(): Promise<void> {\n    return this._readyDelegate.promise;\n  }\n\n\n  get model(): ContentsModel<ContentsProxy.IJupyterContentRow> | undefined {\n    return this.node.model;\n  }\n\n  get selection() {\n    return this.model?.selection;\n  }\n\n  get selectionPathstrs() {\n    return this.model?.selection.map(c => Path.fromarray(c.row.path));\n  }\n\n  /**\n   * Handle the DOM events for the tree view.\n   *\n   * @param event - The DOM event sent to the widget.\n   *\n   * #### Notes\n   * This method implements the DOM `EventListener` interface and is\n   * called in response to events on the panel's DOM node. It should\n   * not be called directly by user code.\n   */\n  handleEvent(event: Event): void {\n    switch (event.type) {\n      case \"keydown\":\n        this.evtKeydown(event as KeyboardEvent);\n        break;\n      case \"dragenter\":\n        this.evtNativeDragOverEnter(event as DragEvent);\n      case \"dragover\":\n        this.evtNativeDragOverEnter(event as DragEvent);\n        break;\n      case \"dragleave\":\n      case \"dragend\":\n        this.evtNativeDragLeaveEnd(event as DragEvent);\n        break;\n      case \"drop\":\n        this.evtNativeDrop(event as DragEvent);\n        break;\n      default:\n        super.handleEvent(event);\n        break;\n    }\n  }\n\n  async load() {\n    if (this._initialLoad) {\n      const node = this.node;\n      await this.nodeInit();\n      this._readyDelegate.resolve();\n      node.addEventListener(\"keydown\", this);\n      node.addEventListener(\"dragenter\", this);\n      node.addEventListener(\"dragover\", this);\n      node.addEventListener(\"dragleave\", this);\n      node.addEventListener(\"dragend\", this);\n      node.addEventListener(\"drop\", this);\n    }\n  }\n\n  /**\n   * A message handler invoked on an `'after-attach'` message.\n   */\n  protected onAfterAttach(msg: Message): void {\n    super.onAfterAttach(msg);\n    void this.load();\n  }\n\n  /**\n   * A message handler invoked on a `'before-detach'` message.\n   */\n  protected onBeforeDetach(msg: Message): void {\n    super.onBeforeDetach(msg);\n    const node = this.node;\n    node.removeEventListener(\"keydown\", this);\n    node.removeEventListener(\"dragover\", this);\n    node.removeEventListener(\"dragover\", this);\n    node.removeEventListener(\"dragleave\", this);\n    node.removeEventListener(\"dragend\", this);\n    node.removeEventListener(\"drop\", this);\n  }\n\n  private _findEventRowElement(event: DragEvent, selector: string): HTMLElement | undefined {\n    let node = event.target as HTMLElement;\n    while (node.parentElement && node.parentElement !== this.node) {\n      if (node.matches(selector)) {\n        return node;\n      }\n      node = node.parentElement;\n    }\n  }\n\n  selectNeighbour(diff: number, asRange: boolean) {\n    const model = this.model!;\n    let last = model.selectedLast;\n    // tree-finder has a bug where it doesn't update selectedLast in `selectRange`, hacky work-around for now:\n    const { range, pivot } = model.selectionModel as any as {range: string[], pivot: string};\n    // once bug is fixed, this conditional should never be true:\n    if (pivot && pivot === last?.pathstr && range && range.length >= 1) {\n      // get the part of range that is furthest away from pivot:\n      const paths = model.contents.map(c => c.pathstr);\n      const pivotIdx = paths.indexOf(pivot);\n      const rangeStartIdx = paths.indexOf(range[0]);\n      const rangeEndIdx = paths.indexOf(range[range.length - 1]);\n      if (pivotIdx < rangeStartIdx) {\n        last = model.contents[rangeEndIdx];\n      } else {\n        last = model.contents[rangeStartIdx];\n      }\n    }\n    let idx = last\n      ? model.contents.indexOf(last)\n      : diff < 0\n        ? model.contents.length - 1  // select last item\n        : 0;  // select first item\n    if (last) {\n      idx = idx + diff;\n    }\n    if (idx < 0 || idx >= model.contents.length) {\n      return;  // Do nothing if going past the edge\n    }\n    const next = model.contents[idx];\n    if (asRange) {\n      model.selectionModel.selectRange(next, model.contents);\n    } else {\n      model.selectionModel.select(next);\n    }\n    void TreeFinderSidebar.scrollIntoView(this, next.pathstr);\n  }\n\n  protected evtKeydown(event: KeyboardEvent): void {\n    // handle any keys unaffacted by renaming status above this check:\n    if (this.parent?.node.classList.contains(\"jfs-mod-renaming\")) {\n      return;\n    }\n    switch (event.key) {\n      case \"ArrowDown\":\n      case \"ArrowUp\":\n        event.stopPropagation();\n        event.preventDefault();\n        this.selectNeighbour(event.key === \"ArrowUp\" ? -1 : 1, event.shiftKey);\n        break;\n      case \"ArrowLeft\":\n        if (this.model?.selectedLast) {\n          event.stopPropagation();\n          event.preventDefault();\n          const selectedLast = this.model.selectedLast;\n          // don't allow expansion or up/down nav if in select range mode:\n          if (!event.shiftKey) {\n            if (selectedLast.isExpand) {\n              void this.model.collapse(this.model.contents.indexOf(selectedLast));\n            } else {\n              // navigate the selection to the next up (exluding to root)\n              void getContentParent(selectedLast, this.model.root).then(parent => {\n                if (parent !== this.model?.root) {\n                  this.model?.selectionModel.select(parent);\n                  return TreeFinderSidebar.scrollIntoView(this, parent.pathstr);\n                }\n              });\n            }\n          }\n        }\n        break;\n      case \"ArrowRight\":\n        if (this.model?.selectedLast) {\n          event.stopPropagation();\n          event.preventDefault();\n          const selectedLast = this.model.selectedLast;\n          // don't allow expansion or up/down nav if in select range mode:\n          if (!event.shiftKey) {\n            if (!selectedLast.isExpand) {\n              void this.model.expand(this.model.contents.indexOf(selectedLast));\n            } else if (selectedLast.hasChildren) {\n              // navigate the selection to the first child\n              void selectedLast.getChildren().then(children => {\n                if (children && children.length > 0) {\n                  this.model?.selectionModel.select(children[0]);\n                  return TreeFinderSidebar.scrollIntoView(this, children[0].pathstr);\n                }\n              });\n            }\n          }\n        }\n        break;\n      case \" \":  // space key\n        // Toggle expansion if dir\n        if (this.model?.selectedLast) {\n          event.stopPropagation();\n          event.preventDefault();\n          const selectedLast = this.model.selectedLast;\n          if (selectedLast.hasChildren) {\n            const selectedIdx = this.model.contents.indexOf(selectedLast);\n            if (selectedLast.isExpand) {\n              void this.model.collapse(selectedIdx);\n            } else {\n              void this.model.expand(selectedIdx);\n            }\n          }\n        }\n        break;\n    }\n  }\n\n  protected evtNativeDragOverEnter(event: DragEvent): void {\n    const row = this._findEventRowElement(event, \"tree-finder-grid tr\");\n    if (row) {\n      row.classList.add(\"jfs-mod-native-drop\");\n    }\n    event.preventDefault();\n  }\n\n  protected evtNativeDragLeaveEnd(event: DragEvent) {\n    const row = this._findEventRowElement(event, \".jfs-mod-native-drop\");\n    if (row) {\n      row.classList.remove(\"jfs-mod-native-drop\");\n    }\n  }\n\n  /**\n   * Handle the `drop` event for the widget.\n   */\n  protected evtNativeDrop(event: DragEvent): void {\n    const row = this.node.querySelector(\".jfs-mod-native-drop\");\n    if (row) {\n      row.classList.remove(\"jfs-mod-native-drop\");\n    }\n    const files = event.dataTransfer?.files;\n    if (!files || files.length === 0) {\n      return;\n    }\n    const length = event.dataTransfer?.items.length;\n    if (!length) {\n      return;\n    }\n    for (let i = 0; i < length; i++) {\n      const entry = event.dataTransfer?.items[i].webkitGetAsEntry();\n      if (entry?.isDirectory) {\n        void showDialog({\n          title: this._trans.__(\"Error Uploading Folder\"),\n          body: this._trans.__(\n            \"Drag and Drop is currently not supported for folders\"\n          ),\n          buttons: [Dialog.cancelButton({ label: this._trans.__(\"Close\") })],\n        });\n      }\n    }\n    event.preventDefault();\n    // Translate row element to contents row\n    let target: Content<ContentsProxy.IJupyterContentRow> = this.model!.root;\n    if (row) {\n      const grid = this.node.querySelector(\"tree-finder-grid\") as TreeFinderGridElement<ContentsProxy.IJupyterContentRow>;\n      const metadata = grid.getMeta(row.querySelector(\"th\")!);\n      if (metadata.y) {\n        target = this.model!.contents[metadata.y];\n      }\n    }\n    for (let i = 0; i < files.length; i++) {\n      void this.uploader!.upload(files[i], target);\n    }\n  }\n\n  contentsProxy: ContentsProxy;\n  rootPath: string;\n  private _columns: Array<keyof ContentsProxy.IJupyterContentRow>;\n  settings: ISettingRegistry.ISettings | undefined;\n  uploader: Uploader | undefined;\n  readonly node: TreeFinderPanelElement<ContentsProxy.IJupyterContentRow>;\n\n  readonly translator: ITranslator;\n\n  private _readyDelegate: PromiseDelegate<void>;\n  private _trans: TranslationBundle;\n  private _commands: CommandRegistry;\n  private _expanding: Map<string, number>;\n  private _initialLoad: boolean;\n  private _currentFolder: string | undefined;\n}\n\nexport namespace TreeFinderWidget {\n  export interface IOptions {\n    app: JupyterFrontEnd;\n    columns: Array<keyof ContentsProxy.IJupyterContentRow>;\n    rootPath: string;\n\n    translator?: ITranslator;\n    settings?: ISettingRegistry.ISettings;\n  }\n}\n\nexport class TreeFinderSidebar extends Widget {\n  constructor({\n    app,\n    columns,\n    url,\n    type,\n    rootPath = \"\",\n    caption = \"TreeFinder\",\n    id = \"jupyterlab-tree-finder\",\n    settings,\n    preferredDir,\n  }: TreeFinderSidebar.IOptions) {\n    super();\n    this.id = id;\n    this.node.classList.add(\"jfs-mod-notRenaming\");\n\n    this.url = url;\n    this.type = type;\n    this.title.icon = fileTreeIcon;\n    this.title.caption = caption;\n    this.addClass(\"jp-tree-finder-sidebar\");\n\n    this.toolbar = new Toolbar();\n    this.toolbar.addClass(\"jp-tree-finder-toolbar\");\n    this.preferredDir = preferredDir;\n\n    this.treefinder = new TreeFinderWidget({ app, rootPath, columns, settings });\n\n    this.layout = new PanelLayout();\n    (this.layout as PanelLayout).addWidget(this.toolbar);\n    (this.layout as PanelLayout).addWidget(this.treefinder);\n\n  }\n\n  restore() { // restore expansion prior to rebuild\n    void this.treefinder.ready.then(() => {\n      this.treefinder.refresh();\n      this.treefinder.draw({ reset: true });\n    });\n  }\n\n  async download(path: string, folder: boolean): Promise<void> {\n    if (folder) {\n      // const zip = new JSZip();\n      // await this.wrapFolder(zip, path); // folder packing\n      // // generate and save zip, reset path\n      // path = PathExt.basename(path);\n      // writeZipFile(zip, path);\n    } else {\n      const url = await this.treefinder.contentsProxy.downloadUrl(path);\n      const element = document.createElement(\"a\");\n      element.setAttribute(\"href\", url);\n      element.setAttribute(\"download\", \"\");\n      document.body.appendChild(element);\n      element.click();\n      document.body.removeChild(element);\n    }\n  }\n\n  // async wrapFolder(zip: JSZip, path: string) {\n  //   const base = this.cm.get(this.basepath + path);\n  //   const next = base.then(async res => {\n  //     if (res.type === \"directory\") {\n  //       const new_folder = zip.folder(res.name);\n  //       for (const c in res.content) {\n  //         await this.wrapFolder(new_folder, res.content[c].path);\n  //       }\n  //     } else {\n  //       zip.file(res.name, res.content);\n  //     }\n  //   });\n  //   await next;\n  // }\n\n  protected onAfterShow(msg: any): void {\n    this.treefinder.refresh();\n    this.treefinder.draw({ reset: true });\n    // Temporary workaround for grid size issues\n    (this.treefinder.node.querySelector(\"tree-finder-grid\")?.shadowRoot?.querySelector(\"div.rt-scroll-table-clip\") as HTMLElement).style.height = \"110%\";\n  }\n\n  protected onResize(msg: any): void {\n    this.treefinder.draw();\n  }\n\n  preferredDir: string | undefined;\n  toolbar: Toolbar;\n  treefinder: TreeFinderWidget;\n\n  readonly url: string;\n  readonly type: string;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace TreeFinderSidebar {\n  const namespace = \"jupyter-fs-treefinder\";\n\n  export const tracker = new TreeFinderTracker({ namespace });\n  export const clipboard = new JupyterClipboard(tracker);\n\n  export interface IOptions {\n    app: JupyterFrontEnd;\n    columns: Array<keyof ContentsProxy.IJupyterContentRow>;\n    url: string;\n    type: string;\n    rootPath?: string;\n    caption?: string;\n    id?: string;\n    translator?: ITranslator;\n    settings?: ISettingRegistry.ISettings;\n    preferredDir?: string;\n  }\n\n  export interface ISidebarProps extends IOptions {\n    manager: IDocumentManager;\n    paths: JupyterFrontEnd.IPaths;\n    resolver: IWindowResolver;\n    restorer: ILayoutRestorer;\n    router: IRouter;\n    side?: string;\n    settings?: ISettingRegistry.ISettings;\n    type: string;\n  }\n\n  export function sidebarFromResource(resource: IFSResource, props: TreeFinderSidebar.ISidebarProps): TreeFinderSidebar {\n    return sidebar({\n      ...props,\n      rootPath: resource.drive,\n      caption: resource.name,\n      id: idFromResource(resource),\n      preferredDir: resource.preferredDir,\n      url: resource.url,\n      type: resource.type,\n    });\n  }\n\n  export function sidebar({\n    app,\n    // manager,\n    // paths,\n    // resolver,\n    // router,\n    restorer,\n    url,\n    type,\n    columns,\n    settings,\n    preferredDir,\n    rootPath = \"\",\n    caption = \"TreeFinder\",\n    id = \"jupyterlab-tree-finder\",\n    side = \"left\",\n  }: TreeFinderSidebar.ISidebarProps): TreeFinderSidebar {\n    const widget = new TreeFinderSidebar({ app, rootPath, columns, caption, id, url, type, settings, preferredDir });\n    void widget.treefinder.ready.then(() => tracker.add(widget));\n    app.shell.add(widget, side);\n\n    const new_launcher_button = new ToolbarButton({\n      icon: addIcon,\n      onClick: () => {\n        void app.commands.execute(commandIDs.newLauncher);\n      },\n      tooltip: \"Open Launcher\",\n    });\n\n    const new_file_button = new ToolbarButton({\n      icon: newFolderIcon,\n      onClick: () => {\n        void app.commands.execute((commandIDs.createFolder));\n      },\n      tooltip: \"New Folder\",\n    });\n    const uploader_button = new UploadButton({ uploader: widget.treefinder.ready.then(() => widget.treefinder.uploader!) });\n    void widget.treefinder.ready.then(() => {\n      widget.treefinder.uploader!.uploadCompleted.connect((sender, args) => {\n        // Do not select/scroll into view: Upload might be slow, so user might have moved on!\n        // We do however want to expand the folder\n        void revealPath(widget.treefinder.model!, args.path).then(() =>\n          widget.treefinder.model!.flatten()\n        );\n      });\n    });\n    const refresh_button = new ToolbarButton({\n      icon: refreshIcon,\n      onClick: () => {\n        void app.commands.execute(commandIDs.refresh);\n      },\n      tooltip: \"Refresh\",\n    });\n\n    widget.toolbar.addItem(\"launcher\", new_launcher_button);\n    widget.toolbar.addItem(\"new file\", new_file_button);\n    widget.toolbar.addItem(\"upload\", uploader_button);\n    widget.toolbar.addItem(\"refresh\", refresh_button);\n\n    if (preferredDir) {\n      void widget.treefinder.ready.then(async () => {\n        let path = preferredDir.split(\"/\");\n        if (preferredDir.startsWith(\"/\")) {\n          path = path.slice(1);\n        }\n        path.unshift(rootPath);\n        await openDirRecursive(widget.treefinder.model!, path);\n      });\n    }\n\n    // // remove context highlight on context menu exit\n    // document.ondblclick = () => {\n    //   app.commands.execute((widget.commandIDs.set_context + \":\" + widget.id), { path: \"\" });\n    // };\n    // widget.node.onclick = event => {\n    //   app.commands.execute((widget.commandIDs.select + \":\" + widget.id), { path: \"\" });\n    // };\n\n    // setInterval(() => {\n    //   app.commands.execute(widget.commandIDs.refresh);\n    // }, 10000);\n\n    // return a disposable containing all disposables associated\n    // with this widget, ending with the widget itself\n    return widget;\n  }\n\n  export async function doRename(widget: TreeFinderSidebar, oldContent: Content<ContentsProxy.IJupyterContentRow>): Promise<ContentsProxy.IJupyterContentRow> {\n    if (widget.node.classList.contains(\"jfs-mod-renaming\")) {\n      return oldContent.row;\n    }\n    const textNode = widget.node.querySelector(\"tr.tf-mod-select .rt-tree-container .rt-group-name\")!.firstChild as HTMLElement;\n    const original = textNode.textContent.replace(/(.*)\\/$/, \"$1\");\n    const editNode = document.createElement(\"input\");\n    editNode.value = original;\n    try {\n      widget.node.classList.replace(\"jfs-mod-notRenaming\", \"jfs-mod-renaming\");\n      const newName = await promptRename(textNode, editNode, original);\n      textNode.parentElement?.focus();\n      if (!newName || newName === oldContent.name) {\n        return oldContent.row;\n      }\n      if (!isValidFileName(newName)) {\n        void showErrorMessage(\n          \"Rename Error\",\n          Error(newName +' is not a valid name. Names must have nonzero length, and cannot include \"/\", \"\\\\\", or \":\"')\n        );\n        return oldContent.row;\n      }\n      const oldPath = oldContent.getPathAtDepth(1).join(\"/\");\n      const newPath = oldPath.slice(0, -1 * original.length) + newName;\n      const suffix = textNode.textContent.endsWith(\"/\") ? \"/\" : \"\";\n      let newContent;\n      try {\n        newContent = await widget.treefinder.contentsProxy.rename(oldPath + suffix, newPath + suffix);\n      } catch (error) {\n        if (error !== \"File not renamed\") {\n          void showErrorMessage(\n            \"Rename Error\",\n            error as string\n          );\n        }\n        newContent = oldContent.row;\n      }\n      textNode.textContent = newName + suffix;\n      return newContent;\n    } finally {\n      widget.node.classList.replace(\"jfs-mod-renaming\", \"jfs-mod-notRenaming\");\n    }\n  }\n\n  /**\n   * If a path entry is not in view, scroll it into view\n   *\n   * @param treefinder The view\n   * @param pathstr The entry to show\n   */\n  export async function scrollIntoView(treefinder: TreeFinderWidget, pathstr: string) {\n    // tree-finder uses rxjs bits that don't allow you to await, so to ensure sync draw:\n    const model = treefinder.model!;\n    await model.flatten();\n    const grid = treefinder.node.querySelector(\"tree-finder-grid\") as TreeFinderGridElement<ContentsProxy.IJupyterContentRow>;\n    // eslint-disable-next-line @typescript-eslint/await-thenable\n    await grid.draw();\n    // Check if new row (selection) in view (if outside virtual window, it will fail):\n    if (!treefinder.node.querySelector(\".tf-mod-select .rt-tree-container .rt-group-name\")) {\n      // We need to scroll the selection into view!\n      const rowIdx = model.contents.findIndex(s => s.pathstr === pathstr);\n      if (rowIdx !== -1) {\n        // TODO: Should we perform a minimum scroll, or do we always want entry as close to the top of the view as possible?\n        await grid.scrollToCell(0, rowIdx, 1, model.contents.length);\n      }\n    }\n  }\n}\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\n/* Based on code from JupyterLab, copied under the following license:\n\nCopyright (c) 2015-2021 Project Jupyter Contributors\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this\n   list of conditions and the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice,\n   this list of conditions and the following disclaimer in the documentation\n   and/or other materials provided with the distribution.\n\n3. Neither the name of the copyright holder nor the names of its\n   contributors may be used to endorse or promote products derived from\n   this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\nAND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\nIMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\nFOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\nSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\nCAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\nOR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport { showErrorMessage, ToolbarButton  } from \"@jupyterlab/apputils\";\nimport { IChangedArgs } from \"@jupyterlab/coreutils\";\nimport { shouldOverwrite } from \"@jupyterlab/docmanager\";\nimport { Contents } from \"@jupyterlab/services\";\nimport {\n  ITranslator,\n  nullTranslator,\n  TranslationBundle,\n} from \"@jupyterlab/translation\";\nimport { fileUploadIcon } from \"@jupyterlab/ui-components\";\nimport { ArrayExt } from \"@lumino/algorithm\";\nimport { IDisposable } from \"@lumino/disposable\";\nimport { ISignal, Signal } from \"@lumino/signaling\";\nimport { Content, ContentsModel } from \"@tree-finder/base\";\n\nimport type { ContentsProxy } from \"./contents_proxy\";\nimport { getContentParent } from \"./contents_utils\";\n\n\n/**\n * The size (in bytes) of the biggest chunk we should upload at once.\n */\nexport const CHUNK_SIZE = 1024 * 1024;\n\n/**\n * An upload completed to `path`.\n */\nexport interface IUploadedData {\n  path: string[];\n}\n\n/**\n* An upload progress event for a file at `path`.\n*/\nexport interface IUploadProgress {\n  path: string;\n  /**\n  * % uploaded [0, 1)\n  */\n  progress: number;\n}\n\nexport class UploadButton extends ToolbarButton {\n  /**\n   * Construct a new file browser buttons widget.\n   */\n  constructor(options: UploadButton.IOptions) {\n    super({\n      icon: fileUploadIcon,\n      label: options.label,\n      onClick: () => {\n        this._input.click();\n      },\n      tooltip: Private.translateToolTip(options.translator),\n    });\n    this.translator = options.translator || nullTranslator;\n    this._trans = this.translator.load(\"jupyterlab\");\n    this._uploader = options.uploader;\n    this._input.onclick = this._onInputClicked;\n    this._input.onchange = this._onInputChanged;\n    this.addClass(\"jp-id-upload\");\n  }\n\n  /**\n   * The 'change' handler for the input field.\n   */\n  private _onInputChanged = () => {\n    const files = Array.prototype.slice.call(this._input.files) as File[];\n    const pending = files.map(async file => (await this._uploader).upload(file));\n    void Promise.all(pending).catch(error => {\n      void showErrorMessage(\n        this._trans._p(\"showErrorMessage\", \"Upload Error\"),\n        error as string\n      );\n    });\n  };\n\n  /**\n   * The 'click' handler for the input field.\n   */\n  private _onInputClicked = () => {\n    // In order to allow repeated uploads of the same file (with delete in between),\n    // we need to clear the input value to trigger a change event.\n    this._input.value = \"\";\n  };\n\n  protected translator: ITranslator;\n  private _trans: TranslationBundle;\n  private _input = Private.createUploadInput();\n  private _uploader: Promise<Uploader>;\n}\n\nexport namespace UploadButton {\n  export interface IOptions {\n    /**\n     * The language translator.\n     */\n    translator?: ITranslator;\n\n    /**\n     * An optional label.\n     */\n    label?: string;\n\n    /**\n     * Pormise to uploader instance to handle upload logic\n     */\n    uploader: Promise<Uploader>\n  }\n}\n\n/**\n * A widget which provides an upload button.\n */\nexport class Uploader implements IDisposable {\n  /**\n   * Construct a new file browser buttons widget.\n   */\n  constructor(options: Uploader.IOptions) {\n    this.model = options.model;\n    this._contentsProxy = options.contentsProxy;\n  }\n\n  /**\n   * A signal emitted when an upload progresses.\n   */\n  get uploadChanged(): ISignal<this, IChangedArgs<IUploadProgress | null>> {\n    return this._uploadChanged;\n  }\n\n  /**\n   * A signal emitted when an upload completes.\n   */\n  get uploadCompleted(): ISignal<this, IUploadedData> {\n    return this._uploadCompleted;\n  }\n\n  /**\n   * Is this instance disposed?\n   */\n  get isDisposed() {\n    return this._disposed;\n  }\n\n  /**\n   * Dispose of the resources held by the model.\n   */\n  dispose(): void {\n    if (this.isDisposed) {\n      return;\n    }\n    this._disposed = true;\n    Signal.clearData(this);\n  }\n\n  /**\n   * Upload a `File` object.\n   *\n   * @param file - The `File` object to upload.\n   *\n   * @returns A promise containing the new file contents model.\n   */\n  async upload(file: File, target?: Content<ContentsProxy.IJupyterContentRow>): Promise<ContentsProxy.IJupyterContentRow | null> {\n    await this._uploadCheckDisposed();\n    target = target || this.model.selectedLast || this.model.root;\n    if (!target.hasChildren) {\n      target = await getContentParent(target, this.model.root);\n    }\n    const path = target.pathstr ? target.pathstr + \"/\" + file.name : file.name;\n    let res = null;\n    try {\n      // alternatively to try to get the file and check for 404, we can get the parent\n      // and check if the file is in the list.\n      res = await this._contentsProxy.get(path, { content: false });\n    } catch (e) {\n      // TODO: Check if e is a 404\n    }\n    if (res) {\n      // drop drive when prompting:\n      if (!await shouldOverwrite(path.slice(path.indexOf(\"/\") + 1))) {\n        return null;\n      }\n    }\n    await this._uploadCheckDisposed();\n    const chunkedUpload = file.size > CHUNK_SIZE;\n    const uploaded = await this._upload(file, path, chunkedUpload);\n    target.invalidate();\n    this._uploadCompleted.emit({ path: uploaded.path });\n    return uploaded;\n  }\n\n  /**\n   * Perform the actual upload.\n   */\n  private async _upload(\n    file: File,\n    path: string,\n    chunked: boolean\n  ): Promise<ContentsProxy.IJupyterContentRow> {\n    // Gather the file model parameters.\n    const name = file.name;\n    const type: Contents.ContentType = \"file\";\n    const format: Contents.FileFormat = \"base64\";\n\n    const uploadInner = async (\n      blob: Blob,\n      chunk?: number\n    ): Promise<ContentsProxy.IJupyterContentRow> => {\n      await this._uploadCheckDisposed();\n      const reader = new FileReader();\n      reader.readAsDataURL(blob);\n      await new Promise((resolve, reject) => {\n        reader.onload = resolve;\n        reader.onerror = event =>\n          reject(`Failed to upload \"${file.name}\":  ${event}`);\n      });\n      await this._uploadCheckDisposed();\n\n      // remove header https://stackoverflow.com/a/24289420/907060\n      const content = (reader.result as string).split(\",\")[1];\n\n      const model: Partial<Contents.IModel> = {\n        type,\n        format,\n        name,\n        chunk,\n        content,\n      };\n      return await this._contentsProxy.save(path, model);\n    };\n\n    if (!chunked) {\n      try {\n        return await uploadInner(file);\n      } catch (err) {\n        ArrayExt.removeFirstWhere(this._uploads, uploadIndex => file.name === uploadIndex.path);\n        throw err;\n      }\n    }\n\n    let finalModel: ContentsProxy.IJupyterContentRow | undefined;\n\n    let upload = { path, progress: 0 };\n    this._uploadChanged.emit({\n      name: \"start\",\n      newValue: upload,\n      oldValue: null,\n    });\n\n    for (let start = 0; !finalModel; start += CHUNK_SIZE) {\n      const end = start + CHUNK_SIZE;\n      const lastChunk = end >= file.size;\n      const chunk = lastChunk ? -1 : end / CHUNK_SIZE;\n\n      const newUpload = { path, progress: start / file.size };\n      this._uploads.splice(this._uploads.indexOf(upload));\n      this._uploads.push(newUpload);\n      this._uploadChanged.emit({\n        name: \"update\",\n        newValue: newUpload,\n        oldValue: upload,\n      });\n      upload = newUpload;\n\n      let currentModel: ContentsProxy.IJupyterContentRow;\n      try {\n        currentModel = await uploadInner(file.slice(start, end), chunk);\n      } catch (err) {\n        ArrayExt.removeFirstWhere(this._uploads, uploadIndex => file.name === uploadIndex.path);\n\n        this._uploadChanged.emit({\n          name: \"failure\",\n          newValue: upload,\n          oldValue: null,\n        });\n\n        throw err;\n      }\n\n      if (lastChunk) {\n        finalModel = currentModel;\n      }\n    }\n\n    this._uploads.splice(this._uploads.indexOf(upload));\n    this._uploadChanged.emit({\n      name: \"finish\",\n      newValue: null,\n      oldValue: upload,\n    });\n\n    return finalModel;\n  }\n\n  private _uploadCheckDisposed(): Promise<void> {\n    if (this.isDisposed) {\n      return Promise.reject(\"Filemanager disposed. File upload canceled\");\n    }\n    return Promise.resolve();\n  }\n\n\n  model: ContentsModel<ContentsProxy.IJupyterContentRow>;\n  private _contentsProxy: ContentsProxy;\n  private _uploads: IUploadProgress[] = [];\n  private _uploadChanged = new Signal<this, IChangedArgs<IUploadProgress | null>>(\n    this\n  );\n  private _uploadCompleted = new Signal<this, IUploadedData>(\n    this\n  );\n  private _disposed = false;\n}\n\n\n/**\n * The namespace for Uploader class statics.\n */\nexport namespace Uploader {\n  /**\n   * The options used to create an uploader.\n   */\n  export interface IOptions {\n\n    /**\n     * Contents model\n     */\n    model: ContentsModel<ContentsProxy.IJupyterContentRow>;\n\n    /**\n     * Contents manager proxy\n     */\n    contentsProxy: ContentsProxy;\n  }\n}\n\n/**\n * The namespace for module private data.\n */\nnamespace Private {\n  /**\n   * Create the upload input node for a file buttons widget.\n   */\n  export function createUploadInput(): HTMLInputElement {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.multiple = true;\n    return input;\n  }\n\n  /**\n   * Translate upload tooltip.\n   */\n  export function translateToolTip(translator?: ITranslator): string {\n    translator = translator || nullTranslator;\n    const trans = translator.load(\"jupyterlab\");\n    return trans.__(\"Upload Files\");\n  }\n}\n","/******************************************************************************\n *\n * Copyright (c) 2019, the jupyter-fs authors.\n *\n * This file is part of the jupyter-fs library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport { PageConfig, PathExt } from \"@jupyterlab/coreutils\";\nimport { Widget } from \"@lumino/widgets\";\nimport { saveAs } from \"file-saver\";\nimport JSZip from \"jszip\";\n\n\nexport const Patterns = {\n  tree: new RegExp(`^${PageConfig.getOption(\"treeUrl\")}([^?]+)`),\n  workspace: new RegExp(`^${PageConfig.getOption(\"workspacesUrl\")}[^?/]+/tree/([^?]+)`),\n};\n\n/**\n * Version of btoa that omits any \"=\" padding chars at the end\n */\nexport function btoaNopad(s: string): string {\n  return btoa(s).replace(/=+$/, \"\");\n}\n\nexport function createOpenNode(): HTMLElement {\n  const body = document.createElement(\"div\");\n  const existingLabel = document.createElement(\"label\");\n  existingLabel.textContent = \"File Path:\";\n\n  const input = document.createElement(\"input\");\n  input.value = \"\";\n  input.placeholder = \"/path/to/file\";\n\n  body.appendChild(existingLabel);\n  body.appendChild(input);\n  return body;\n}\n\nexport function promptRename(\n  text: HTMLElement,\n  edit: HTMLInputElement,\n  original: string\n): Promise<string> {\n  const parent = text.parentElement as HTMLElement;\n  parent.replaceChild(edit, text);\n  edit.focus();\n  const index = edit.value.lastIndexOf('.');\n  if (index === -1) {\n    edit.setSelectionRange(0, edit.value.length);\n  } else {\n    edit.setSelectionRange(0, index);\n  }\n\n  return new Promise<string>((resolve, reject) => {\n    edit.onblur = () => {\n      parent.replaceChild(text, edit);\n      resolve(edit.value);\n    };\n    edit.onkeydown = (event: KeyboardEvent) => {\n      switch (event.keyCode) {\n        case 13: // Enter\n          event.stopPropagation();\n          event.preventDefault();\n          edit.blur();\n          break;\n        case 27: // Escape\n          event.stopPropagation();\n          event.preventDefault();\n          edit.value = original;\n          edit.blur();\n          break;\n        case 38: // Up arrow\n          event.stopPropagation();\n          event.preventDefault();\n          if (edit.selectionStart !== edit.selectionEnd) {\n            edit.selectionStart = edit.selectionEnd = 0;\n          }\n          break;\n        case 40: // Down arrow\n          event.stopPropagation();\n          event.preventDefault();\n          if (edit.selectionStart !== edit.selectionEnd) {\n            edit.selectionStart = edit.selectionEnd = edit.value.length;\n          }\n          break;\n        default:\n          break;\n      }\n    };\n  });\n}\n\nexport function fileSizeString(fileBytes: number) {\n  if (fileBytes == null) {\n    return \"\";\n  }\n  if (fileBytes < 1024) {\n    return fileBytes + \" B\";\n  }\n\n  let i = -1;\n  const byteUnits = [\" KB\", \" MB\", \" GB\", \" TB\"];\n  do {\n    fileBytes = fileBytes / 1024;\n    i++;\n  } while (fileBytes > 1024);\n\n  return Math.max(fileBytes, 0.1).toFixed(1) + byteUnits[i];\n}\n\nexport function switchView(mode: any) {\n  if (mode === \"none\") {\n    return \"\";\n  } else {\n    return \"none\";\n  }\n}\n\nexport function writeZipFile(zip: JSZip, path: string) {\n  zip.generateAsync({ type: \"blob\" }).then(content => {\n    saveAs(content, PathExt.basename(path));\n  });\n}\n\nexport class OpenDirectWidget extends Widget {\n\n  constructor() {\n    super({ node: createOpenNode() });\n  }\n\n  getValue(): string {\n    return this.inputNode.value;\n  }\n\n  get inputNode(): HTMLInputElement {\n    return this.node.getElementsByTagName(\"input\")[0];\n  }\n}\n"],"names":[],"sourceRoot":""}